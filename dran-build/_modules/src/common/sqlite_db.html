
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>src.common.sqlite_db &#8212; dran v1.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/nature.css" />
    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/sphinx_highlight.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">dran v1.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" accesskey="U">Module code</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">src.common.sqlite_db</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for src.common.sqlite_db</h1><div class="highlight"><pre>
<span></span><span class="c1"># =========================================================================== #</span>
<span class="c1"># File    : sqlite_db.py                                                      #</span>
<span class="c1"># Author  : Pfesesani V. van Zyl                                              #</span>
<span class="c1"># =========================================================================== #</span>

<span class="c1"># Standard library imports</span>
<span class="c1"># --------------------------------------------------------------------------- #</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">sqlite3</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># Local imports</span>
<span class="c1"># --------------------------------------------------------------------------- #</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;src/&quot;</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">common.messaging</span> <span class="kn">import</span> <span class="n">msg_wrapper</span>
<span class="kn">import</span> <span class="nn">common.exceptions</span> <span class="k">as</span> <span class="nn">ex</span>
<span class="kn">import</span> <span class="nn">common.calc_pss</span> <span class="k">as</span> <span class="nn">cp</span>
<span class="c1"># =========================================================================== #</span>

<div class="viewcode-block" id="SQLiteDB"><a class="viewcode-back" href="../../../docs/src.common.html#src.common.sqlite_db.SQLiteDB">[docs]</a><span class="k">class</span> <span class="nc">SQLiteDB</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; The SQLite database. </span>

<span class="sd">        This can be either a calibration or target database depending on the source under investigation.</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            object_type (str): Type of object e.g. CALIBRATOR/TARGET source</span>
<span class="sd">            object_folder (str): Name of containing folder</span>
<span class="sd">            databaseName (str): Name of the database</span>
<span class="sd">            log (object): Logging object</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">object_type</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">object_folder</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">databaseName</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="n">log</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">object_type</span> <span class="o">=</span> <span class="n">object_type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">object_folder</span> <span class="o">=</span> <span class="n">object_folder</span>

        <span class="c1">#print(&#39;type: &#39;,self.object_type,self.object_folder)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span> <span class="o">=</span> <span class="n">log</span>
        <span class="k">if</span> <span class="n">databaseName</span><span class="o">!=</span><span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_database_name</span><span class="p">(</span><span class="n">databaseName</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">databaseName</span> <span class="o">=</span> <span class="n">databaseName</span>
        
        <span class="n">msg_wrapper</span><span class="p">(</span><span class="s2">&quot;debug&quot;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">,</span><span class="s2">&quot;SQLite database initiated&quot;</span><span class="p">)</span>
      
<div class="viewcode-block" id="SQLiteDB.db_exists"><a class="viewcode-back" href="../../../docs/src.common.html#src.common.sqlite_db.SQLiteDB.db_exists">[docs]</a>    <span class="k">def</span> <span class="nf">db_exists</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">dbname</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;check if database exists. &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">dbname</span><span class="p">)</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">msg_wrapper</span><span class="p">(</span><span class="s2">&quot;debug&quot;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">,</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">dbname</span><span class="si">}</span><span class="s1"> exists&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">msg_wrapper</span><span class="p">(</span><span class="s2">&quot;debug&quot;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">,</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">dbname</span><span class="si">}</span><span class="s1"> does not exists&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="SQLiteDB.create_db"><a class="viewcode-back" href="../../../docs/src.common.html#src.common.sqlite_db.SQLiteDB.create_db">[docs]</a>    <span class="k">def</span> <span class="nf">create_db</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Create a new database. &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">databaseName</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span></div>

<div class="viewcode-block" id="SQLiteDB.set_database_name"><a class="viewcode-back" href="../../../docs/src.common.html#src.common.sqlite_db.SQLiteDB.set_database_name">[docs]</a>    <span class="k">def</span> <span class="nf">set_database_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">databaseName</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Set the name of the database. &quot;&quot;&quot;</span>

        <span class="n">msg_wrapper</span><span class="p">(</span><span class="s2">&quot;debug&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">,</span> <span class="s2">&quot;Setup database name&quot;</span><span class="p">)</span>

       
        <span class="k">if</span> <span class="s2">&quot;.db&quot;</span> <span class="ow">in</span> <span class="n">databaseName</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">databaseName</span> <span class="o">=</span> <span class="n">databaseName</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">databaseName</span> <span class="o">=</span> <span class="n">databaseName</span><span class="o">+</span><span class="s2">&quot;.db&quot;</span></div>

<div class="viewcode-block" id="SQLiteDB.setup_database"><a class="viewcode-back" href="../../../docs/src.common.html#src.common.sqlite_db.SQLiteDB.setup_database">[docs]</a>    <span class="k">def</span> <span class="nf">setup_database</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Setup the database that will be used to store our data. &quot;&quot;&quot;</span>

   
        <span class="k">if</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object_type</span> <span class="o">==</span> <span class="s2">&quot;CAL&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_database_name</span><span class="p">(</span><span class="s2">&quot;CALDB&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_database_name</span><span class="p">(</span><span class="s2">&quot;TARDB&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">create_db</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_table_name</span><span class="p">()</span></div>

<div class="viewcode-block" id="SQLiteDB.validate_table_name"><a class="viewcode-back" href="../../../docs/src.common.html#src.common.sqlite_db.SQLiteDB.validate_table_name">[docs]</a>    <span class="k">def</span> <span class="nf">validate_table_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tableName</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Validate that the table name adheres to SQLite standards.</span>

<span class="sd">            SQLite does not support names that contain the &quot;- and .&quot; characters.</span>
<span class="sd">            This method checks if a folder name has the &quot;-/.&quot; character.</span>
<span class="sd">            If found, the character is changed to an underscore (&quot;_&quot;).</span>

<span class="sd">            Args:</span>
<span class="sd">                tableName (str): The name of the table</span>

<span class="sd">            returns:</span>
<span class="sd">                tableName (str): Validated name of table </span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">msg_wrapper</span><span class="p">(</span><span class="s2">&quot;debug&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">,</span>
                    <span class="s2">&quot;Validating table name adheres to naming standards.&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">tableName</span><span class="o">==</span><span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="n">msg_wrapper</span><span class="p">(</span><span class="s2">&quot;debug&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">,</span> <span class="s2">&quot;Table name has not been given, setting name to object folder name&quot;</span><span class="p">)</span>
            <span class="n">tableName</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">object_folder</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="n">invalidChars</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="s1">&#39;+&#39;</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">invalidChars</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">invalidChars</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;+&quot;</span><span class="p">:</span>
                <span class="n">tableName</span> <span class="o">=</span> <span class="n">tableName</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">invalidChars</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="s2">&quot;plus&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">name</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">tableName</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                    <span class="n">tableName</span> <span class="o">=</span> <span class="s2">&quot;_&quot;</span><span class="o">+</span><span class="n">tableName</span>
                    <span class="n">tableName</span> <span class="o">=</span> <span class="n">tableName</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">invalidChars</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="s2">&quot;_&quot;</span><span class="p">)</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="n">tableName</span> <span class="o">=</span> <span class="n">tableName</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">invalidChars</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="s2">&quot;_&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">tableName</span></div>

<div class="viewcode-block" id="SQLiteDB.get_table_name"><a class="viewcode-back" href="../../../docs/src.common.html#src.common.sqlite_db.SQLiteDB.get_table_name">[docs]</a>    <span class="k">def</span> <span class="nf">get_table_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tableName</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Validate the name of a specified database table. &quot;&quot;&quot;</span>

        <span class="n">msg_wrapper</span><span class="p">(</span><span class="s2">&quot;debug&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">,</span> <span class="s2">&quot;Getting table name &quot;</span><span class="p">)</span>

        <span class="c1"># create or fetch table and set lower case</span>
        <span class="k">if</span> <span class="n">tableName</span><span class="o">==</span><span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="n">tableName</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">validate_table_name</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object_folder</span><span class="p">))</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_table_name</span><span class="p">(</span><span class="n">tableName</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">tableName</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">validate_table_name</span><span class="p">(</span><span class="n">tableName</span><span class="p">))</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">tableName</span></div>

<div class="viewcode-block" id="SQLiteDB.get_table_names"><a class="viewcode-back" href="../../../docs/src.common.html#src.common.sqlite_db.SQLiteDB.get_table_names">[docs]</a>    <span class="k">def</span> <span class="nf">get_table_names</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">db</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get table name from database.</span>
<span class="sd">        The result is a tuple which we convert to </span>
<span class="sd">        a list</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Getting tables from: &quot;</span><span class="p">,</span> <span class="n">db</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_database_name</span><span class="p">(</span><span class="n">db</span><span class="p">)</span>
        
        <span class="n">table_names</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">sql_stmt</span> <span class="o">=</span> <span class="s2">&quot;SELECT name FROM sqlite_master WHERE type = &#39;table&#39;;&quot;</span>
        <span class="n">tables</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">sql_stmt</span><span class="p">)</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
        
        <span class="k">try</span><span class="p">:</span>
            <span class="n">tables</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">sql_stmt</span><span class="p">)</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
        <span class="k">except</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">OperationalError</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Failed to fetch data from the server&quot;</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>

        <span class="c1">#print(&quot;Tables: &quot;,tables)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tables</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">tables</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">):</span>
                <span class="n">table_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tables</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tables</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">tables</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;sqlite_sequence&quot;</span><span class="p">):</span>
                <span class="k">pass</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">table_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tables</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
        <span class="c1">#print(table_names)</span>
        <span class="k">return</span> <span class="n">table_names</span></div>

<div class="viewcode-block" id="SQLiteDB.get_table_coloumns"><a class="viewcode-back" href="../../../docs/src.common.html#src.common.sqlite_db.SQLiteDB.get_table_coloumns">[docs]</a>    <span class="k">def</span> <span class="nf">get_table_coloumns</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table_name</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Get coloumns of table</span>
<span class="sd">            return index, coloumn name and coloumn type</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">col_ind</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">col_name</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">col_type</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;PRAGMA table_info(&#39;</span><span class="si">%s</span><span class="s2">&#39;) &quot;</span> <span class="o">%</span>
                             <span class="n">table_name</span><span class="p">)</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
        <span class="k">except</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">OperationalError</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Failed to fetch table columns from the database&quot;</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>

        <span class="c1">#print(res)</span>
        <span class="c1">#sys.exit()</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">res</span><span class="p">)):</span>
            <span class="c1">#print(res[i][1])</span>
            <span class="k">if</span> <span class="n">res</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;OBSDATE&quot;</span> <span class="ow">or</span> <span class="n">res</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;FILENAME&#39;</span><span class="p">:</span>
                <span class="n">col_ind</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">col_name</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">col_type</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>

            <span class="k">if</span> <span class="n">res</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;TEXT&quot;</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">col_ind</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">col_name</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">col_type</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">col_ind</span><span class="p">,</span> <span class="n">col_name</span><span class="p">,</span> <span class="n">col_type</span></div>

<div class="viewcode-block" id="SQLiteDB.get_table_coloumns2"><a class="viewcode-back" href="../../../docs/src.common.html#src.common.sqlite_db.SQLiteDB.get_table_coloumns2">[docs]</a>    <span class="k">def</span> <span class="nf">get_table_coloumns2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table_name</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Get coloumns of table</span>
<span class="sd">            return index, coloumn name and coloumn type</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">col_ind</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">col_name</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">col_type</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;PRAGMA table_info(&#39;</span><span class="si">%s</span><span class="s2">&#39;) &quot;</span> <span class="o">%</span>
                             <span class="n">table_name</span><span class="p">)</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
        <span class="k">except</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">OperationalError</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Failed to fetch table columns from the database&quot;</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>

        <span class="c1">#print(res)</span>
        <span class="c1">#sys.exit()</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">res</span><span class="p">)):</span>
            <span class="c1">#print(res[i][1])</span>
            <span class="c1"># if res[i][1] == &quot;OBSDATE&quot; or res[i][1]==&#39;FILENAME&#39;:</span>
            <span class="c1">#     col_ind.append(res[i][0])</span>
            <span class="c1">#     col_name.append(res[i][1])</span>
            <span class="c1">#     col_type.append(res[i][2])</span>

            <span class="c1"># if res[i][2] == &quot;TEXT&quot;:</span>
            <span class="c1">#     pass</span>
            <span class="c1"># else:</span>
            <span class="n">col_ind</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">col_name</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">col_type</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">col_ind</span><span class="p">,</span> <span class="n">col_name</span><span class="p">,</span> <span class="n">col_type</span></div>

<div class="viewcode-block" id="SQLiteDB.get_all_table_coloumns"><a class="viewcode-back" href="../../../docs/src.common.html#src.common.sqlite_db.SQLiteDB.get_all_table_coloumns">[docs]</a>    <span class="k">def</span> <span class="nf">get_all_table_coloumns</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table_name</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Get coloumns of table</span>
<span class="sd">            return index, coloumn name and coloumn type</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">col_ind</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">col_name</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">col_type</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;PRAGMA table_info(&#39;</span><span class="si">%s</span><span class="s2">&#39;) &quot;</span> <span class="o">%</span>
                             <span class="n">table_name</span><span class="p">)</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>

        <span class="c1"># print(res)</span>
        <span class="c1"># sys.exit()</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">res</span><span class="p">)):</span>
            <span class="n">col_ind</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">col_name</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">col_type</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">col_ind</span><span class="p">,</span> <span class="n">col_name</span><span class="p">,</span> <span class="n">col_type</span></div>

<div class="viewcode-block" id="SQLiteDB.delete_row"><a class="viewcode-back" href="../../../docs/src.common.html#src.common.sqlite_db.SQLiteDB.delete_row">[docs]</a>    <span class="k">def</span> <span class="nf">delete_row</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">table</span><span class="p">,</span><span class="n">key</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;Delete row from table&#39;&#39;&#39;</span>
        <span class="n">stmt</span> <span class="o">=</span> <span class="s2">&quot;DELETE FROM &quot;</span><span class="o">+</span><span class="n">table</span><span class="o">+</span><span class="s2">&quot; WHERE FILENAME = &#39;&quot;</span><span class="o">+</span><span class="n">key</span><span class="o">+</span><span class="s2">&quot;&#39;;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">stmt</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">commit_changes</span><span class="p">()</span>
        <span class="n">msg_wrapper</span><span class="p">(</span><span class="s2">&quot;info&quot;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">,</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s1"> entry deleted from </span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s1"> database.</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="p">)</span></div>
    
<div class="viewcode-block" id="SQLiteDB.select_row"><a class="viewcode-back" href="../../../docs/src.common.html#src.common.sqlite_db.SQLiteDB.select_row">[docs]</a>    <span class="k">def</span> <span class="nf">select_row</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">table</span><span class="p">,</span><span class="n">key</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;Select row from table&#39;&#39;&#39;</span>
        <span class="n">stmt</span> <span class="o">=</span> <span class="s2">&quot;SELECT * FROM &quot;</span><span class="o">+</span><span class="n">table</span><span class="o">+</span><span class="s2">&quot; WHERE FILENAME = &#39;&quot;</span><span class="o">+</span><span class="n">key</span><span class="o">+</span><span class="s2">&quot;&#39;;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">stmt</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>

        <span class="n">rows</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="p">[</span><span class="n">rows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">)</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">data</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">rows</span></div>

<div class="viewcode-block" id="SQLiteDB.select_row2"><a class="viewcode-back" href="../../../docs/src.common.html#src.common.sqlite_db.SQLiteDB.select_row2">[docs]</a>    <span class="k">def</span> <span class="nf">select_row2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">table</span><span class="p">,</span><span class="n">key</span><span class="p">,</span><span class="n">cmd</span><span class="o">=</span><span class="s2">&quot;=&quot;</span><span class="p">,</span><span class="n">value</span><span class="o">=</span><span class="s2">&quot;100&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;Select row from table&#39;&#39;&#39;</span>
        <span class="n">stmt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;SELECT * FROM </span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s2"> WHERE </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">cmd</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">stmt</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">stmt</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>

        <span class="n">rows</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="p">[</span><span class="n">rows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">)</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">data</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">rows</span></div>

<div class="viewcode-block" id="SQLiteDB.select_row3"><a class="viewcode-back" href="../../../docs/src.common.html#src.common.sqlite_db.SQLiteDB.select_row3">[docs]</a>    <span class="k">def</span> <span class="nf">select_row3</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">table</span><span class="p">,</span><span class="n">key</span><span class="p">,</span><span class="n">cmd</span><span class="o">=</span><span class="s2">&quot;=&quot;</span><span class="p">,</span><span class="n">value</span><span class="o">=</span><span class="s2">&quot;100&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;Select row from table&#39;&#39;&#39;</span>
        <span class="n">stmt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;SELECT * FROM </span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s2"> WHERE </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">cmd</span><span class="si">}</span><span class="s2"> &#39;</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&#39;;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">stmt</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">stmt</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>

        <span class="n">rows</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="p">[</span><span class="n">rows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">)</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">data</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">rows</span></div>

<div class="viewcode-block" id="SQLiteDB.get_rows"><a class="viewcode-back" href="../../../docs/src.common.html#src.common.sqlite_db.SQLiteDB.get_rows">[docs]</a>    <span class="k">def</span> <span class="nf">get_rows</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tbname</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Get the rows in the database table.</span>

<span class="sd">            Parameters</span>
<span class="sd">            ----------</span>
<span class="sd">                tbname : str</span>
<span class="sd">                    table name</span>

<span class="sd">            Returns</span>
<span class="sd">            -------</span>
<span class="sd">                rows: str</span>
<span class="sd">                    table row list</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># print(tbname)</span>
        <span class="c1"># open the database</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">create_db</span><span class="p">()</span>

        <span class="c1"># read from selected table</span>
        <span class="n">stmt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;SELECT * FROM &#39;</span><span class="si">{</span><span class="n">tbname</span><span class="si">}</span><span class="s2">&#39; ORDER BY FILENAME ASC;&quot;</span>
        <span class="c1"># print(stmt)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">stmt</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>

        <span class="c1"># get filenames and return them</span>
        <span class="n">rows</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
            <span class="n">rows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">rows</span></div>

<div class="viewcode-block" id="SQLiteDB.get_rows_of_cols"><a class="viewcode-back" href="../../../docs/src.common.html#src.common.sqlite_db.SQLiteDB.get_rows_of_cols">[docs]</a>    <span class="k">def</span> <span class="nf">get_rows_of_cols</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tbname</span><span class="p">,</span><span class="n">cols</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Get the rows in the database table.</span>

<span class="sd">            Parameters</span>
<span class="sd">            ----------</span>
<span class="sd">                tbname : str</span>
<span class="sd">                    table name</span>

<span class="sd">            Returns</span>
<span class="sd">            -------</span>
<span class="sd">                rows: str</span>
<span class="sd">                    table row list</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1">#tbname=tbname.split(&quot;/&quot;)[-1]</span>
        <span class="c1">#print(tbname,cols)</span>
        <span class="c1">#sys.exit()</span>
        <span class="c1"># open the database</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">create_db</span><span class="p">()</span>

        <span class="n">colNames</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">cols</span><span class="p">)):</span>
                <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                    <span class="n">colNames</span> <span class="o">=</span> <span class="n">colNames</span> <span class="o">+</span> <span class="n">cols</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot; &quot;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">colNames</span> <span class="o">=</span> <span class="n">colNames</span> <span class="o">+</span> <span class="n">cols</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot;, &quot;</span>
     
        <span class="c1"># read from selected table</span>
        <span class="n">stmt</span> <span class="o">=</span> <span class="s2">&quot;SELECT &quot;</span><span class="o">+</span><span class="n">colNames</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot;  FROM &#39;&quot;</span><span class="o">+</span><span class="n">tbname</span><span class="o">+</span><span class="s2">&quot;&#39; ORDER BY FILENAME ASC;&quot;</span>

        <span class="c1"># print(stmt)</span>
        <span class="c1"># print(&#39;\nExecuting: &#39;,stmt,&#39;\n&#39;)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">stmt</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>

        <span class="c1"># get filenames and return them</span>
        <span class="n">rows</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
            <span class="n">rows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">rows</span></div>

<div class="viewcode-block" id="SQLiteDB.set_table_name"><a class="viewcode-back" href="../../../docs/src.common.html#src.common.sqlite_db.SQLiteDB.set_table_name">[docs]</a>    <span class="k">def</span> <span class="nf">set_table_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">tableName</span><span class="p">):</span>
        <span class="n">msg_wrapper</span><span class="p">(</span><span class="s2">&quot;debug&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">,</span> <span class="s2">&quot;Setting table name to: &quot;</span><span class="o">+</span><span class="n">tableName</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tableName</span><span class="o">=</span><span class="n">tableName</span></div>

<div class="viewcode-block" id="SQLiteDB.read_data_from_database"><a class="viewcode-back" href="../../../docs/src.common.html#src.common.sqlite_db.SQLiteDB.read_data_from_database">[docs]</a>    <span class="k">def</span> <span class="nf">read_data_from_database</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">colName</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Read column data from from table.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">sqlStmt</span> <span class="o">=</span> <span class="s2">&quot;SELECT &quot;</span><span class="o">+</span><span class="n">colName</span><span class="o">+</span><span class="s2">&quot; FROM &quot;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">tableName</span><span class="o">+</span><span class="s2">&quot;;&quot;</span>
        <span class="c1">#self.c.execute(sqlStmt)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">sqlStmt</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
           <span class="n">msg_wrapper</span><span class="p">(</span><span class="s2">&quot;warning&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">,</span> <span class="s2">&quot;Failed to read </span><span class="si">{}</span><span class="s2"> column from table &#39;</span><span class="si">{}</span><span class="s2">&#39;, </span><span class="se">\n</span><span class="s2">the table either doesn&#39;t exists or is corrupted. </span><span class="se">\n</span><span class="s2">Attempting to create a new table</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">colName</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">tableName</span><span class="p">))</span>

        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>

        <span class="n">readData</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
            <span class="n">readData</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">readData</span> </div>

<div class="viewcode-block" id="SQLiteDB.close_db"><a class="viewcode-back" href="../../../docs/src.common.html#src.common.sqlite_db.SQLiteDB.close_db">[docs]</a>    <span class="k">def</span> <span class="nf">close_db</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Close the database connection.&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>

<div class="viewcode-block" id="SQLiteDB.save_to_database"><a class="viewcode-back" href="../../../docs/src.common.html#src.common.sqlite_db.SQLiteDB.save_to_database">[docs]</a>    <span class="k">def</span> <span class="nf">save_to_database</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">tableName</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Save data to database &quot;&quot;&quot;</span>

        <span class="c1">#print(&#39;\nData: &#39;,data)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">data</span><span class="p">[</span><span class="s1">&#39;NLTAPEAKLOC&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;NLTAPEAKLOC&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">data</span><span class="p">[</span><span class="s1">&#39;SLTAPEAKLOC&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;SLTAPEAKLOC&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">data</span><span class="p">[</span><span class="s1">&#39;OLTAPEAKLOC&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;OLTAPEAKLOC&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>
        
        <span class="k">try</span><span class="p">:</span>
            <span class="n">data</span><span class="p">[</span><span class="s1">&#39;SRTAPEAKLOC&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;SRTAPEAKLOC&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">data</span><span class="p">[</span><span class="s1">&#39;NRTAPEAKLOC&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;NRTAPEAKLOC&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>
        
        <span class="k">try</span><span class="p">:</span>
            <span class="n">data</span><span class="p">[</span><span class="s1">&#39;ORTAPEAKLOC&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;ORTAPEAKLOC&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="c1"># for k,v in data.items():</span>
        <span class="c1">#     if &quot;TAPEAK&quot; in k:</span>
        <span class="c1">#         print(k,v, )</span>
        <span class="c1"># sys.exit()</span>

        <span class="n">table</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_table_name</span><span class="p">(</span><span class="n">tableName</span><span class="p">)</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">set_table_name</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">create_table</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">table</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">populate_table</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">table</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">msg_wrapper</span><span class="p">(</span><span class="s2">&quot;debug&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">,</span>
                        <span class="s2">&quot;Captured data to database&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="n">msg_wrapper</span><span class="p">(</span><span class="s2">&quot;debug&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">,</span>
                        <span class="s2">&quot;Values already captured to database&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="SQLiteDB.create_table"><a class="viewcode-back" href="../../../docs/src.common.html#src.common.sqlite_db.SQLiteDB.create_table">[docs]</a>    <span class="k">def</span> <span class="nf">create_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">tableName</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Create an sql statement to create a table.&quot;&quot;&quot;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">create_db</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="c1">#print(data)</span>
        <span class="c1">#sys.exit()</span>
        <span class="n">sqlStmt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_table_stmt</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">tableName</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">sqlStmt</span><span class="p">)</span></div>

<div class="viewcode-block" id="SQLiteDB.create_table_stmt"><a class="viewcode-back" href="../../../docs/src.common.html#src.common.sqlite_db.SQLiteDB.create_table_stmt">[docs]</a>    <span class="k">def</span> <span class="nf">create_table_stmt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">tableName</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Create table from dictionary. &quot;&quot;&quot;</span>

        <span class="n">sqlStmt</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
       
        <span class="c1">#print(data.items())</span>
        <span class="c1">#sys.exit()</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="c1"># Make the filename a foreign key</span>
            <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;FILENAME&quot;</span><span class="p">:</span>
                <span class="n">sqlStmt</span> <span class="o">=</span> <span class="n">sqlStmt</span> <span class="o">+</span> \
                    <span class="s1">&#39;CREATE TABLE IF NOT EXISTS &#39;</span> <span class="o">+</span> <span class="n">tableName</span> <span class="o">+</span> <span class="s2">&quot; (&quot;</span>
                <span class="n">idKey</span> <span class="o">=</span> <span class="n">sqlStmt</span> <span class="o">+</span> <span class="s2">&quot;id INTEGER PRIMARY KEY AUTOINCREMENT&quot;</span> <span class="o">+</span> <span class="s2">&quot;, &quot;</span>
                <span class="n">sqlStmt</span> <span class="o">=</span> <span class="n">idKey</span> <span class="o">+</span> <span class="n">key</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="s2">&quot;TEXT&quot;</span> <span class="o">+</span> <span class="s2">&quot; UNIQUE , &quot;</span>
            <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;float&quot;</span><span class="p">:</span>
                <span class="n">sqlStmt</span> <span class="o">=</span> <span class="n">sqlStmt</span> <span class="o">+</span> <span class="n">key</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="s2">&quot;REAL&quot;</span> <span class="o">+</span> <span class="s2">&quot; , &quot;</span>
            <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;float64&quot;</span><span class="p">:</span>
                <span class="n">sqlStmt</span> <span class="o">=</span> <span class="n">sqlStmt</span> <span class="o">+</span> <span class="n">key</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="s2">&quot;REAL&quot;</span> <span class="o">+</span> <span class="s2">&quot; , &quot;</span>
            <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;int&quot;</span><span class="p">:</span>
                <span class="n">sqlStmt</span> <span class="o">=</span> <span class="n">sqlStmt</span> <span class="o">+</span> <span class="n">key</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="s2">&quot;INTEGER&quot;</span> <span class="o">+</span> <span class="s2">&quot; , &quot;</span>
            <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;str&quot;</span><span class="p">:</span>
                <span class="n">sqlStmt</span> <span class="o">=</span> <span class="n">sqlStmt</span> <span class="o">+</span> <span class="n">key</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="s2">&quot;TEXT&quot;</span> <span class="o">+</span> <span class="s2">&quot; , &quot;</span>
        <span class="n">sqlStmt</span> <span class="o">=</span> <span class="n">sqlStmt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span>
      
        <span class="k">return</span> <span class="n">sqlStmt</span></div>

<div class="viewcode-block" id="SQLiteDB.insert_into_table_stmt_with_pk"><a class="viewcode-back" href="../../../docs/src.common.html#src.common.sqlite_db.SQLiteDB.insert_into_table_stmt_with_pk">[docs]</a>    <span class="k">def</span> <span class="nf">insert_into_table_stmt_with_pk</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">tableName</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Insert values into table and create a primary key.&quot;&quot;&quot;</span>

        <span class="n">sqlStmt</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

        <span class="n">dataListKey</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="n">dataListKeyString</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">dataListValues</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
        <span class="n">dataListValueString</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">dataListValues</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">dataListKeyString</span> <span class="o">=</span> <span class="n">dataListKeyString</span> <span class="o">+</span> <span class="n">dataListKey</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">dataListKeyString</span> <span class="o">=</span> <span class="n">dataListKeyString</span> <span class="o">+</span> <span class="s2">&quot;, &quot;</span> <span class="o">+</span> <span class="n">dataListKey</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

        <span class="n">placeHolders</span> <span class="o">=</span> <span class="s2">&quot;?,&quot;</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">sqlStmt</span> <span class="o">=</span> <span class="s2">&quot;INSERT INTO &quot;</span> <span class="o">+</span> <span class="n">tableName</span> <span class="o">+</span> \
            <span class="s2">&quot; (&quot;</span> <span class="o">+</span> <span class="n">dataListKeyString</span> <span class="o">+</span> <span class="s2">&quot;) VALUES (&quot;</span> <span class="o">+</span> <span class="n">placeHolders</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span>

        <span class="k">return</span> <span class="n">sqlStmt</span><span class="p">,</span> <span class="n">dataListValues</span></div>

<div class="viewcode-block" id="SQLiteDB.populate_table"><a class="viewcode-back" href="../../../docs/src.common.html#src.common.sqlite_db.SQLiteDB.populate_table">[docs]</a>    <span class="k">def</span> <span class="nf">populate_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">tableName</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; populate a database table with values. &quot;&quot;&quot;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">create_db</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="c1">#print(&#39;data: &#39;,data)</span>

        <span class="n">sqlStmt</span><span class="p">,</span> <span class="n">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">insert_into_table_stmt_with_pk</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">tableName</span><span class="p">)</span>
       
        <span class="c1">#print(sqlStmt)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">sqlStmt</span><span class="p">,</span> <span class="n">values</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;issue: &quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">commit_changes</span><span class="p">()</span></div>

<div class="viewcode-block" id="SQLiteDB.commit_changes"><a class="viewcode-back" href="../../../docs/src.common.html#src.common.sqlite_db.SQLiteDB.commit_changes">[docs]</a>    <span class="k">def</span> <span class="nf">commit_changes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Commit/save changes you have implemented to the database. &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span></div>

<div class="viewcode-block" id="SQLiteDB.get_update_query_wb"><a class="viewcode-back" href="../../../docs/src.common.html#src.common.sqlite_db.SQLiteDB.get_update_query_wb">[docs]</a>    <span class="k">def</span> <span class="nf">get_update_query_wb</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">status</span><span class="p">,</span> <span class="n">beams</span><span class="p">,</span> <span class="n">keys</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the values and keys which will be </span>
<span class="sd">        updated in the database, this is for wide </span>
<span class="sd">        beam data.&quot;&quot;&quot;</span>

        <span class="n">dbKeys</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;OLTA&quot;</span><span class="p">,</span> <span class="s2">&quot;ORTA&quot;</span><span class="p">]</span>
        <span class="n">queryItems</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">queryDict</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">if</span> <span class="p">(</span><span class="mi">1</span> <span class="ow">in</span> <span class="n">status</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="mi">2</span> <span class="ow">in</span> <span class="n">status</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">beams</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">beams</span><span class="p">)):</span>
                    <span class="k">if</span> <span class="n">beams</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;ONLCP&quot;</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">status</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">status</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                            <span class="n">start</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">keys</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">dbKeys</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
                            <span class="n">end</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">keys</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">dbKeys</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
                            <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
                                <span class="n">queryItems</span> <span class="o">=</span> <span class="n">queryItems</span> <span class="o">+</span> \
                                    <span class="n">keys</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot; = &#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">values</span><span class="p">[</span><span class="n">t</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;&#39;,&quot;</span>
                                <span class="n">queryDict</span><span class="p">[</span><span class="n">keys</span><span class="p">[</span><span class="n">t</span><span class="p">]]</span> <span class="o">=</span> <span class="n">values</span><span class="p">[</span><span class="n">t</span><span class="p">]</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="k">pass</span>
                    <span class="k">elif</span> <span class="n">beams</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;ONRCP&quot;</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">status</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">status</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                            <span class="n">start</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">keys</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">dbKeys</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
                            <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)):</span>
                                <span class="n">queryItems</span> <span class="o">=</span> <span class="n">queryItems</span> <span class="o">+</span> \
                                    <span class="n">keys</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot; = &#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">values</span><span class="p">[</span><span class="n">t</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;&#39;,&quot;</span>
                                <span class="n">queryDict</span><span class="p">[</span><span class="n">keys</span><span class="p">[</span><span class="n">t</span><span class="p">]]</span> <span class="o">=</span> <span class="n">values</span><span class="p">[</span><span class="n">t</span><span class="p">]</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="k">pass</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">msg_wrapper</span><span class="p">(</span><span class="s2">&quot;debug&quot;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Saving everything as nans</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">beams</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;ONLCP&quot;</span><span class="p">:</span>
                <span class="n">start</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">keys</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">dbKeys</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
                <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)):</span>
                    <span class="k">if</span> <span class="s2">&quot;FLAG&quot;</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">[</span><span class="n">t</span><span class="p">]:</span>
                        <span class="n">queryItems</span> <span class="o">=</span> <span class="n">queryItems</span> <span class="o">+</span> \
                            <span class="n">keys</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot; = &#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">values</span><span class="p">[</span><span class="n">t</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;&#39;,&quot;</span>
                        <span class="n">queryDict</span><span class="p">[</span><span class="n">keys</span><span class="p">[</span><span class="n">t</span><span class="p">]]</span> <span class="o">=</span> <span class="n">values</span><span class="p">[</span><span class="n">t</span><span class="p">]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">queryItems</span> <span class="o">=</span> <span class="n">queryItems</span> <span class="o">+</span> \
                            <span class="n">keys</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot; = &#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&#39;,&quot;</span>
                        <span class="n">queryDict</span><span class="p">[</span><span class="n">keys</span><span class="p">[</span><span class="n">t</span><span class="p">]]</span> <span class="o">=</span> <span class="n">values</span><span class="p">[</span><span class="n">t</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">queryItems</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">queryDict</span></div>

<div class="viewcode-block" id="SQLiteDB.populate_queries"><a class="viewcode-back" href="../../../docs/src.common.html#src.common.sqlite_db.SQLiteDB.populate_queries">[docs]</a>    <span class="k">def</span> <span class="nf">populate_queries</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">status</span><span class="p">,</span> <span class="n">keys</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">dbKeys</span><span class="p">,</span> <span class="n">ind1</span><span class="p">,</span> <span class="n">ind2</span><span class="p">,</span> <span class="n">queryItems</span><span class="p">,</span> <span class="n">queryDict</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Populate the query dictionary and query items. &quot;&quot;&quot;</span>
      
        <span class="k">if</span> <span class="n">status</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">status</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">start</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">keys</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">dbKeys</span><span class="p">[</span><span class="n">ind1</span><span class="p">]))</span>
            <span class="n">end</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">keys</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">dbKeys</span><span class="p">[</span><span class="n">ind2</span><span class="p">]))</span>

            <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
                <span class="n">queryItems</span> <span class="o">=</span> <span class="n">queryItems</span> <span class="o">+</span> \
                    <span class="n">keys</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot; = &#39;&quot;</span> <span class="o">+</span> \
                    <span class="nb">str</span><span class="p">(</span><span class="n">values</span><span class="p">[</span><span class="n">t</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;&#39;,&quot;</span>
                <span class="n">queryDict</span><span class="p">[</span><span class="n">keys</span><span class="p">[</span><span class="n">t</span><span class="p">]]</span> <span class="o">=</span> <span class="n">values</span><span class="p">[</span><span class="n">t</span><span class="p">]</span>
        
      
        <span class="k">return</span> <span class="n">queryItems</span><span class="p">,</span> <span class="n">queryDict</span></div>

<div class="viewcode-block" id="SQLiteDB.get_update_query_nb"><a class="viewcode-back" href="../../../docs/src.common.html#src.common.sqlite_db.SQLiteDB.get_update_query_nb">[docs]</a>    <span class="k">def</span> <span class="nf">get_update_query_nb</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">status</span><span class="p">,</span> <span class="n">beams</span><span class="p">,</span> <span class="n">keys</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Get the values and keys which will be </span>
<span class="sd">        updated in the database, this is for narrow </span>
<span class="sd">        beam data.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1">#print(keys)</span>
        <span class="k">if</span> <span class="s2">&quot;SLTA&quot;</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
            <span class="n">dbKeys</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;SLTA&quot;</span><span class="p">,</span> <span class="s2">&quot;NLTA&quot;</span><span class="p">,</span> <span class="s2">&quot;OLTA&quot;</span><span class="p">,</span> <span class="s2">&quot;SRTA&quot;</span><span class="p">,</span> <span class="s2">&quot;NRTA&quot;</span><span class="p">,</span> <span class="s2">&quot;ORTA&quot;</span><span class="p">]</span>
        <span class="k">elif</span> <span class="s2">&quot;ASLTA&quot;</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
            <span class="n">dbKeys</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;ASLTA&quot;</span><span class="p">,</span> <span class="s2">&quot;BSLTA&quot;</span><span class="p">,</span> <span class="s2">&quot;ANLTA&quot;</span><span class="p">,</span> <span class="s2">&quot;BNLTA&quot;</span><span class="p">,</span> <span class="s2">&quot;AOLTA&quot;</span><span class="p">,</span> <span class="s2">&quot;BOLTA&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;ASRTA&quot;</span><span class="p">,</span> <span class="s2">&quot;BSRTA&quot;</span><span class="p">,</span> <span class="s2">&quot;ANRTA&quot;</span><span class="p">,</span> <span class="s2">&quot;BNRTA&quot;</span><span class="p">,</span> <span class="s2">&quot;AORTA&quot;</span><span class="p">,</span> <span class="s2">&quot;BORTA&quot;</span><span class="p">]</span>

        <span class="n">queryItems</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">queryDict</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">if</span> <span class="p">(</span><span class="mi">1</span> <span class="ow">in</span> <span class="n">status</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="mi">2</span> <span class="ow">in</span> <span class="n">status</span><span class="p">):</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">beams</span><span class="p">)</span> <span class="o">==</span> <span class="mi">6</span><span class="p">:</span>

                <span class="k">if</span> <span class="s2">&quot;SLTA&quot;</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">beams</span><span class="p">)):</span>
                        <span class="k">if</span> <span class="n">beams</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;HPSLCP&quot;</span><span class="p">:</span>
                            <span class="n">queryItems</span><span class="p">,</span> <span class="n">queryDict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">populate_queries</span><span class="p">(</span>
                                <span class="n">i</span><span class="p">,</span> <span class="n">status</span><span class="p">,</span> <span class="n">keys</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">dbKeys</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">queryItems</span><span class="p">,</span> <span class="n">queryDict</span><span class="p">)</span>

                        <span class="k">elif</span> <span class="n">beams</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;HPNLCP&quot;</span><span class="p">:</span>
                            <span class="n">queryItems</span><span class="p">,</span> <span class="n">queryDict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">populate_queries</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">status</span><span class="p">,</span> <span class="n">keys</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">dbKeys</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">queryItems</span><span class="p">,</span> <span class="n">queryDict</span><span class="p">)</span>

                        <span class="k">elif</span> <span class="n">beams</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;ONLCP&quot;</span><span class="p">:</span>
                            <span class="n">queryItems</span><span class="p">,</span> <span class="n">queryDict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">populate_queries</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">status</span><span class="p">,</span> <span class="n">keys</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">dbKeys</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span> <span class="n">queryItems</span><span class="p">,</span> <span class="n">queryDict</span><span class="p">)</span>

                        <span class="k">elif</span> <span class="n">beams</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;HPSRCP&quot;</span><span class="p">:</span>
                            <span class="n">queryItems</span><span class="p">,</span> <span class="n">queryDict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">populate_queries</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">status</span><span class="p">,</span> <span class="n">keys</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">dbKeys</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span> <span class="n">queryItems</span><span class="p">,</span> <span class="n">queryDict</span><span class="p">)</span>

                        <span class="k">elif</span> <span class="n">beams</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;HPNRCP&quot;</span><span class="p">:</span>
                            <span class="n">queryItems</span><span class="p">,</span> <span class="n">queryDict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">populate_queries</span><span class="p">(</span>
                                <span class="n">i</span><span class="p">,</span> <span class="n">status</span><span class="p">,</span> <span class="n">keys</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">dbKeys</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">queryItems</span><span class="p">,</span> <span class="n">queryDict</span><span class="p">)</span>

                        <span class="k">elif</span> <span class="n">beams</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;ONRCP&quot;</span><span class="p">:</span>
                            <span class="k">if</span> <span class="n">status</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">status</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                                <span class="n">start</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">keys</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">dbKeys</span><span class="p">[</span><span class="mi">5</span><span class="p">]))</span>
                                <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)):</span>
                                    <span class="n">queryItems</span> <span class="o">=</span> <span class="n">queryItems</span> <span class="o">+</span> \
                                        <span class="n">keys</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot; = &#39;&quot;</span> <span class="o">+</span> \
                                        <span class="nb">str</span><span class="p">(</span><span class="n">values</span><span class="p">[</span><span class="n">t</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;&#39;,&quot;</span>
                                    <span class="n">queryDict</span><span class="p">[</span><span class="n">keys</span><span class="p">[</span><span class="n">t</span><span class="p">]]</span> <span class="o">=</span> <span class="n">values</span><span class="p">[</span><span class="n">t</span><span class="p">]</span>

                <span class="k">elif</span> <span class="s2">&quot;ASLTA&quot;</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>

                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">beams</span><span class="p">)):</span>

                        <span class="k">if</span> <span class="n">beams</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;HPSLCP&quot;</span><span class="p">:</span>
                            <span class="n">queryItems</span><span class="p">,</span> <span class="n">queryDict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">populate_queries</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">status</span><span class="p">,</span> <span class="n">keys</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">dbKeys</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">queryItems</span><span class="p">,</span> <span class="n">queryDict</span><span class="p">)</span>
                            
                        <span class="k">elif</span> <span class="n">beams</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;HPNLCP&quot;</span><span class="p">:</span>
                            <span class="n">queryItems</span><span class="p">,</span> <span class="n">queryDict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">populate_queries</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">status</span><span class="p">,</span> <span class="n">keys</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">dbKeys</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span> <span class="n">queryItems</span><span class="p">,</span> <span class="n">queryDict</span><span class="p">)</span>

                        <span class="k">elif</span> <span class="n">beams</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;ONLCP&quot;</span><span class="p">:</span>
                            <span class="n">queryItems</span><span class="p">,</span> <span class="n">queryDict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">populate_queries</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">status</span><span class="p">,</span> <span class="n">keys</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">dbKeys</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span> <span class="n">queryItems</span><span class="p">,</span> <span class="n">queryDict</span><span class="p">)</span>

                        <span class="k">elif</span> <span class="n">beams</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;HPSRCP&quot;</span><span class="p">:</span>
                            <span class="n">queryItems</span><span class="p">,</span> <span class="n">queryDict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">populate_queries</span><span class="p">(</span>
                                <span class="n">i</span><span class="p">,</span> <span class="n">status</span><span class="p">,</span> <span class="n">keys</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">dbKeys</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="n">queryItems</span><span class="p">,</span> <span class="n">queryDict</span><span class="p">)</span>

                        <span class="k">elif</span> <span class="n">beams</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;HPNRCP&quot;</span><span class="p">:</span>
                            <span class="k">if</span> <span class="n">status</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">status</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                                <span class="n">queryItems</span><span class="p">,</span> <span class="n">queryDict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">populate_queries</span><span class="p">(</span>
                                    <span class="n">i</span><span class="p">,</span> <span class="n">status</span><span class="p">,</span> <span class="n">keys</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">dbKeys</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">queryItems</span><span class="p">,</span> <span class="n">queryDict</span><span class="p">)</span>

                        <span class="k">elif</span> <span class="n">beams</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;ONRCP&quot;</span><span class="p">:</span>
                            <span class="k">if</span> <span class="n">status</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">status</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                                <span class="n">start</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">keys</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">dbKeys</span><span class="p">[</span><span class="mi">10</span><span class="p">]))</span>
                                <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)):</span>
                                    <span class="n">queryItems</span> <span class="o">=</span> <span class="n">queryItems</span> <span class="o">+</span> \
                                        <span class="n">keys</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot; = &#39;&quot;</span> <span class="o">+</span> \
                                        <span class="nb">str</span><span class="p">(</span><span class="n">values</span><span class="p">[</span><span class="n">t</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;&#39;,&quot;</span>
                                    <span class="n">queryDict</span><span class="p">[</span><span class="n">keys</span><span class="p">[</span><span class="n">t</span><span class="p">]]</span> <span class="o">=</span> <span class="n">values</span><span class="p">[</span><span class="n">t</span><span class="p">]</span>

        <span class="k">else</span><span class="p">:</span>

            <span class="k">if</span> <span class="n">dbKeys</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;SLTA&quot;</span> <span class="ow">or</span> <span class="n">dbKeys</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;ASLTA&quot;</span><span class="p">:</span>

                <span class="n">start</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">keys</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">dbKeys</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
                <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)):</span>
                    <span class="k">if</span> <span class="s2">&quot;FLAG&quot;</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">[</span><span class="n">t</span><span class="p">]:</span>  
                        <span class="n">queryItems</span> <span class="o">=</span> <span class="n">queryItems</span> <span class="o">+</span> \
                            <span class="n">keys</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot; = &#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&#39;,&quot;</span>
                        <span class="n">queryDict</span><span class="p">[</span><span class="n">keys</span><span class="p">[</span><span class="n">t</span><span class="p">]]</span> <span class="o">=</span> <span class="n">values</span><span class="p">[</span><span class="n">t</span><span class="p">]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">queryItems</span> <span class="o">=</span> <span class="n">queryItems</span> <span class="o">+</span> \
                            <span class="n">keys</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot; = &#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&#39;,&quot;</span>
                        <span class="n">queryDict</span><span class="p">[</span><span class="n">keys</span><span class="p">[</span><span class="n">t</span><span class="p">]]</span> <span class="o">=</span> <span class="n">values</span><span class="p">[</span><span class="n">t</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">queryItems</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">queryDict</span></div>

<div class="viewcode-block" id="SQLiteDB.update_row_in_db"><a class="viewcode-back" href="../../../docs/src.common.html#src.common.sqlite_db.SQLiteDB.update_row_in_db">[docs]</a>    <span class="k">def</span> <span class="nf">update_row_in_db</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">status</span><span class="p">,</span> <span class="n">beams</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Update a row in a table. &quot;&quot;&quot;</span>

        <span class="c1">#print(table, filename)</span>
        <span class="n">keys</span> <span class="o">=</span> <span class="nb">list</span><span class="p">((</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="n">values</span> <span class="o">=</span> <span class="nb">list</span><span class="p">((</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">beams</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>

            <span class="n">queryItems</span><span class="p">,</span> <span class="n">queryDict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_update_query_wb</span><span class="p">(</span>
                <span class="n">data</span><span class="p">,</span> <span class="n">status</span><span class="p">,</span> <span class="n">beams</span><span class="p">,</span> <span class="n">keys</span><span class="p">,</span> <span class="n">values</span><span class="p">)</span>

            <span class="c1">#print(&#39;\nqueryDict: &#39;, queryDict)</span>
            <span class="c1">#print(&#39;\nqueryItems: &#39;, queryItems)</span>

            <span class="n">queryKeys</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">queryDict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
            <span class="n">queryValues</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">queryDict</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>

            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">query keys: &#39;</span><span class="p">,</span><span class="n">queryKeys</span><span class="p">)</span>

            <span class="n">dbKeysList</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">queryKeys</span><span class="p">:</span>
                <span class="k">if</span> <span class="s2">&quot;TA&quot;</span> <span class="ow">in</span> <span class="n">key</span><span class="p">:</span>
                    <span class="n">dbKeysList</span> <span class="o">=</span> <span class="n">dbKeysList</span> <span class="o">+</span> <span class="n">key</span><span class="o">+</span><span class="s2">&quot;,&quot;</span>
   
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">List of keys from database: &quot;</span><span class="p">,</span> <span class="n">dbKeysList</span><span class="p">)</span>
       
            <span class="k">if</span> <span class="mi">1</span> <span class="ow">in</span> <span class="n">status</span><span class="p">:</span>

                <span class="c1"># get data from database</span>
                <span class="k">if</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;OBJECTTYPE&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;CAL&quot;</span><span class="p">:</span>
                    <span class="n">stmt</span> <span class="o">=</span> <span class="s2">&quot;SELECT FLUX,&quot;</span><span class="o">+</span><span class="n">dbKeysList</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot; FROM &quot;</span><span class="o">+</span><span class="n">table</span> <span class="o">+</span> \
                        <span class="s1">&#39; WHERE FILENAME = &quot;&#39;</span> <span class="o">+</span> <span class="n">filename</span><span class="o">+</span><span class="s1">&#39;&quot; ;&#39;</span>
                
                    <span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">stmt</span><span class="p">)</span>
                    <span class="n">databaseData</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>

                    <span class="n">flux</span> <span class="o">=</span> <span class="n">databaseData</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

                    <span class="c1"># update pss</span>
                    <span class="k">if</span> <span class="s1">&#39;OLTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;updating lcp pss&quot;</span><span class="p">)</span>

                        <span class="n">psslcp</span><span class="p">,</span> <span class="n">dpsslcp</span><span class="p">,</span> <span class="n">appEfflcp</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pss</span><span class="p">(</span>
                            <span class="n">flux</span><span class="p">,</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;OLTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;OLDTA&quot;</span><span class="p">])</span>
                        <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;OLPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">psslcp</span>
                        <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;OLDPSS&#39;</span><span class="p">]</span><span class="o">=</span> <span class="n">dpsslcp</span>
                        <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;OLAPPEFF&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">appEfflcp</span>
                      
                    <span class="k">if</span> <span class="s1">&#39;ORTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;updating rcp pss&#39;</span><span class="p">)</span>

                        <span class="n">pssrcp</span><span class="p">,</span> <span class="n">dpssrcp</span><span class="p">,</span> <span class="n">appEffrcp</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pss</span><span class="p">(</span>
                            <span class="n">flux</span><span class="p">,</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;ORTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;ORDTA&quot;</span><span class="p">])</span>
                        <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ORPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pssrcp</span>
                        <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ORDPSS&#39;</span><span class="p">]</span><span class="o">=</span> <span class="n">dpssrcp</span>
                        <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ORAPPEFF&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">appEffrcp</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="n">stmt</span> <span class="o">=</span> <span class="s2">&quot;SELECT &quot;</span><span class="o">+</span><span class="n">dbKeysList</span><span class="o">+</span><span class="s2">&quot; FROM &quot;</span><span class="o">+</span><span class="n">table</span> <span class="o">+</span> \
                        <span class="s1">&#39; WHERE FILENAME = &quot;&#39;</span> <span class="o">+</span> <span class="n">filename</span><span class="o">+</span><span class="s1">&#39;&quot; ;&#39;</span> 

            <span class="k">elif</span> <span class="mi">2</span> <span class="ow">in</span> <span class="n">status</span><span class="p">:</span>

                <span class="c1"># get data from database</span>
                <span class="k">if</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;OBJECTTYPE&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;CAL&quot;</span><span class="p">:</span>
                    <span class="n">stmt</span> <span class="o">=</span> <span class="s2">&quot;SELECT FLUX,&quot;</span><span class="o">+</span><span class="n">dbKeysList</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot; FROM &quot;</span><span class="o">+</span><span class="n">table</span> <span class="o">+</span> \
                        <span class="s1">&#39; WHERE FILENAME = &quot;&#39;</span> <span class="o">+</span> <span class="n">filename</span><span class="o">+</span><span class="s1">&#39;&quot; ;&#39;</span>

                    <span class="k">if</span> <span class="s1">&#39;OLTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;setting lcp pss to None&#39;</span><span class="p">)</span>
                        <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;OLPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
                        <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;OLDPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
                        <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;OLAPPEFF&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>

                    <span class="k">if</span> <span class="s1">&#39;ORTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;setting rcp pss to None&#39;</span><span class="p">)</span>
                        <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ORPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
                        <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ORDPSS&#39;</span><span class="p">]</span><span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
                        <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ORAPPEFF&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="n">stmt</span> <span class="o">=</span> <span class="s2">&quot;SELECT &quot;</span><span class="o">+</span><span class="n">dbKeysList</span><span class="o">+</span><span class="s2">&quot; FROM &quot;</span><span class="o">+</span><span class="n">table</span> <span class="o">+</span> \
                        <span class="s1">&#39; WHERE FILENAME = &quot;&#39;</span> <span class="o">+</span> <span class="n">filename</span><span class="o">+</span><span class="s1">&#39;&quot; ;&#39;</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">-&gt; Setting everything to nans&quot;</span><span class="p">)</span>

        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">beams</span><span class="p">)</span> <span class="o">==</span> <span class="mi">6</span><span class="p">:</span>
            <span class="n">queryItems</span><span class="p">,</span> <span class="n">queryDict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_update_query_nb</span><span class="p">(</span>
                <span class="n">data</span><span class="p">,</span> <span class="n">status</span><span class="p">,</span> <span class="n">beams</span><span class="p">,</span> <span class="n">keys</span><span class="p">,</span> <span class="n">values</span><span class="p">)</span>
            
            <span class="n">queryKeys</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">queryDict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
            <span class="n">queryValues</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">queryDict</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>

            <span class="n">dbKeysList</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">queryKeys</span><span class="p">)):</span>
                <span class="k">if</span> <span class="s2">&quot;TA&quot;</span> <span class="ow">in</span> <span class="n">queryKeys</span><span class="p">[</span><span class="n">d</span><span class="p">]:</span>
                    <span class="n">dbKeysList</span> <span class="o">=</span> <span class="n">dbKeysList</span> <span class="o">+</span> <span class="n">queryKeys</span><span class="p">[</span><span class="n">d</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot;,&quot;</span>
                <span class="k">elif</span> <span class="s2">&quot;PSS&quot;</span> <span class="ow">in</span> <span class="n">queryKeys</span><span class="p">[</span><span class="n">d</span><span class="p">]:</span>
                    <span class="n">dbKeysList</span> <span class="o">=</span> <span class="n">dbKeysList</span> <span class="o">+</span> <span class="n">queryKeys</span><span class="p">[</span><span class="n">d</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot;,&quot;</span>

            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Updating: &quot;</span><span class="p">,</span> <span class="n">dbKeysList</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
      
            <span class="k">if</span> <span class="s2">&quot;SLTA&quot;</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
                <span class="n">dbKeys</span> <span class="o">=</span> <span class="s2">&quot;SLTA,SLDTA,NLTA,NLDTA,OLTA,OLDTA,SRTA,SRDTA,NRTA,NRDTA,ORTA,ORDTA&quot;</span>

            <span class="k">elif</span> <span class="s2">&quot;ASLTA&quot;</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
                <span class="n">dbKeys</span> <span class="o">=</span> <span class="s2">&quot;ASLTA, ASLDTA, BSLTA, BSLDTA, ANLTA, ANLDTA, BNLTA, BNLDTA, AOLTA, AOLDTA, BOLTA, BOLDTA, ASRTA, ASRDTA, BSRTA, BSRDTA , ANRTA, ANRDTA, BNRTA, BNRDTA, AORTA, AORDTA, BORTA, BORDTA&quot;</span>

            <span class="k">if</span> <span class="mi">1</span> <span class="ow">in</span> <span class="n">status</span> <span class="ow">or</span> <span class="mi">2</span> <span class="ow">in</span> <span class="n">status</span><span class="p">:</span>

                <span class="c1"># get data from database</span>
                <span class="k">if</span> <span class="s2">&quot;TAR&quot;</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;OBJECTTYPE&#39;</span><span class="p">]:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
                    <span class="n">stmt</span> <span class="o">=</span> <span class="s2">&quot;SELECT &quot;</span><span class="o">+</span><span class="n">dbKeys</span><span class="o">+</span><span class="s2">&quot; FROM &quot;</span><span class="o">+</span><span class="n">table</span> <span class="o">+</span> \
                        <span class="s1">&#39; WHERE FILENAME = &quot;&#39;</span> <span class="o">+</span> <span class="n">filename</span><span class="o">+</span><span class="s1">&#39;&quot; ;&#39;</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">stmt</span><span class="p">)</span>
                    <span class="n">databaseData</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>

                    <span class="k">if</span> <span class="s2">&quot;S&quot;</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;BEAMTYPE&#39;</span><span class="p">]:</span>
                        <span class="n">flux</span> <span class="o">=</span> <span class="n">databaseData</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                        <span class="n">slta</span> <span class="o">=</span> <span class="n">databaseData</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
                        <span class="n">sldta</span> <span class="o">=</span> <span class="n">databaseData</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                        <span class="n">nlta</span> <span class="o">=</span> <span class="n">databaseData</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
                        <span class="n">nldta</span> <span class="o">=</span> <span class="n">databaseData</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">4</span><span class="p">]</span>
                        <span class="n">olta</span> <span class="o">=</span> <span class="n">databaseData</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">5</span><span class="p">]</span>
                        <span class="n">oldta</span> <span class="o">=</span> <span class="n">databaseData</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">6</span><span class="p">]</span>
                        <span class="n">srta</span> <span class="o">=</span> <span class="n">databaseData</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">7</span><span class="p">]</span>
                        <span class="n">srdta</span> <span class="o">=</span> <span class="n">databaseData</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">8</span><span class="p">]</span>
                        <span class="n">nrta</span> <span class="o">=</span> <span class="n">databaseData</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">9</span><span class="p">]</span>
                        <span class="n">nrdta</span> <span class="o">=</span> <span class="n">databaseData</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">10</span><span class="p">]</span>
                        <span class="n">orta</span> <span class="o">=</span> <span class="n">databaseData</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">11</span><span class="p">]</span>
                        <span class="n">ordta</span> <span class="o">=</span> <span class="n">databaseData</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">12</span><span class="p">]</span>

                        <span class="c1"># FOR LCP</span>
                        <span class="k">if</span> <span class="s1">&#39;SLTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;NLTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;OLTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span><span class="p">:</span>

                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;recalculate pss for all lcp&#39;</span><span class="p">)</span>
                            <span class="n">pss</span><span class="p">,</span> <span class="n">psserr</span><span class="p">,</span> <span class="n">pc</span><span class="p">,</span> <span class="n">Tcorr</span><span class="p">,</span> <span class="n">Tcorerr</span><span class="p">,</span> <span class="n">appEff</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pc_pss</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> 
                            <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;SLTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;SLDTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;NLTA&quot;</span><span class="p">],</span> 
                            <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;NLDTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;OLTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;OLDTA&quot;</span><span class="p">],</span> <span class="n">flux</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;OLPC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pc</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;COLTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;COLDTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorerr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;OLPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pss</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;OLDPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">psserr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;OLAPPEFF&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">appEff</span>

                        <span class="k">if</span> <span class="s1">&#39;SLTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;NLTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;OLTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span><span class="p">:</span>

                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;recalculate pss for hps and hpn lcp&#39;</span><span class="p">)</span>
                            <span class="n">pss</span><span class="p">,</span> <span class="n">psserr</span><span class="p">,</span> <span class="n">pc</span><span class="p">,</span> <span class="n">Tcorr</span><span class="p">,</span> <span class="n">Tcorerr</span><span class="p">,</span> <span class="n">appEff</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pc_pss</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span>
                                <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;SLTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;SLDTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;NLTA&quot;</span><span class="p">],</span> 
                                <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;NLDTA&quot;</span><span class="p">],</span> <span class="n">olta</span><span class="p">,</span> <span class="n">oldta</span><span class="p">,</span> <span class="n">flux</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;OLPC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pc</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;COLTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;COLDTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorerr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;OLPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pss</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;OLDPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">psserr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;OLAPPEFF&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">appEff</span>

                        <span class="k">if</span> <span class="s1">&#39;SLTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;NLTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;OLTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span><span class="p">:</span>

                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;recalculate pss for s and o lcp&#39;</span><span class="p">)</span>
                            <span class="n">pss</span><span class="p">,</span> <span class="n">psserr</span><span class="p">,</span> <span class="n">pc</span><span class="p">,</span> <span class="n">Tcorr</span><span class="p">,</span> <span class="n">Tcorerr</span><span class="p">,</span> <span class="n">appEff</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pc_pss</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> 
                            <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;SLTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;SLDTA&quot;</span><span class="p">],</span> <span class="n">nlta</span><span class="p">,</span> <span class="n">nldta</span><span class="p">,</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;OLTA&quot;</span><span class="p">],</span> 
                            <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;OLDTA&quot;</span><span class="p">],</span> <span class="n">flux</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;OLPC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pc</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;COLTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;COLDTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorerr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;OLPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pss</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;OLDPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">psserr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;OLAPPEFF&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">appEff</span>

                        <span class="k">if</span> <span class="s1">&#39;SLTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;NLTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;OLTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span><span class="p">:</span>

                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;recalculate pss for s lcp&#39;</span><span class="p">)</span>
                            <span class="n">pss</span><span class="p">,</span> <span class="n">psserr</span><span class="p">,</span> <span class="n">pc</span><span class="p">,</span> <span class="n">Tcorr</span><span class="p">,</span> <span class="n">Tcorerr</span><span class="p">,</span> <span class="n">appEff</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pc_pss</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span>
                                <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;SLTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;SLDTA&quot;</span><span class="p">],</span> <span class="n">nlta</span><span class="p">,</span> <span class="n">nldta</span><span class="p">,</span> <span class="n">olta</span><span class="p">,</span> <span class="n">oldta</span><span class="p">,</span> 
                                <span class="n">flux</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;OLPC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pc</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;COLTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;COLDTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorerr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;OLPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pss</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;OLDPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">psserr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;OLAPPEFF&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">appEff</span>
                            
                        <span class="k">if</span> <span class="s1">&#39;SLTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;NLTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;OLTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span><span class="p">:</span>

                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;recalculate pss for n lcp&#39;</span><span class="p">)</span>
                            <span class="n">pss</span><span class="p">,</span> <span class="n">psserr</span><span class="p">,</span> <span class="n">pc</span><span class="p">,</span> <span class="n">Tcorr</span><span class="p">,</span> <span class="n">Tcorerr</span><span class="p">,</span> <span class="n">appEff</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pc_pss</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span>
                                <span class="n">slta</span><span class="p">,</span> <span class="n">sldta</span><span class="p">,</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;NLTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;NLDTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;OLTA&quot;</span><span class="p">],</span> 
                                <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;OLDTA&quot;</span><span class="p">],</span> <span class="n">flux</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;OLPC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pc</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;COLTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;COLDTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorerr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;OLPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pss</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;OLDPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">psserr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;OLAPPEFF&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">appEff</span>

                        <span class="k">if</span> <span class="s1">&#39;SLTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;NLTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;OLTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span><span class="p">:</span>

                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;recalculate pss for o lcp&#39;</span><span class="p">)</span>
                            <span class="n">pss</span><span class="p">,</span> <span class="n">psserr</span><span class="p">,</span> <span class="n">pc</span><span class="p">,</span> <span class="n">Tcorr</span><span class="p">,</span> <span class="n">Tcorerr</span><span class="p">,</span> <span class="n">appEff</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pc_pss</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span>
                                <span class="n">slta</span><span class="p">,</span> <span class="n">sldta</span><span class="p">,</span> <span class="n">nlta</span><span class="p">,</span> <span class="n">nldta</span><span class="p">,</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;OLTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;OLDTA&quot;</span><span class="p">],</span> 
                                <span class="n">flux</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;OLPC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pc</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;COLTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;COLDTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorerr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;OLPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pss</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;OLDPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">psserr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;OLAPPEFF&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">appEff</span>

                        <span class="k">if</span> <span class="s1">&#39;SLTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;NLTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;OLTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span><span class="p">:</span>

                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;recalculate pss for s and o lcp&#39;</span><span class="p">)</span>
                            <span class="n">pss</span><span class="p">,</span> <span class="n">psserr</span><span class="p">,</span> <span class="n">pc</span><span class="p">,</span> <span class="n">Tcorr</span><span class="p">,</span> <span class="n">Tcorerr</span><span class="p">,</span> <span class="n">appEff</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pc_pss</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span>
                                <span class="n">slta</span><span class="p">,</span> <span class="n">sldta</span><span class="p">,</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;NLTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;NLDTA&quot;</span><span class="p">],</span> <span class="n">olta</span><span class="p">,</span> <span class="n">oldta</span><span class="p">,</span> 
                                <span class="n">flux</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;OLPC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pc</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;COLTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;COLDTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorerr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;OLPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pss</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;OLDPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">psserr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;OLAPPEFF&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">appEff</span>

                        <span class="c1"># FOR RCP</span>
                        <span class="k">if</span> <span class="s1">&#39;SRTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;NRTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;ORTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span><span class="p">:</span>

                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;recalculate pss for all rcp&#39;</span><span class="p">)</span>
                            <span class="n">pss</span><span class="p">,</span> <span class="n">psserr</span><span class="p">,</span> <span class="n">pc</span><span class="p">,</span> <span class="n">Tcorr</span><span class="p">,</span> <span class="n">Tcorerr</span><span class="p">,</span> <span class="n">appEff</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pc_pss</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span>
                                <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;SRTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;SRDTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;NRTA&quot;</span><span class="p">],</span> 
                                <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;NRDTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;ORTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;ORDTA&quot;</span><span class="p">],</span> 
                                <span class="n">flux</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ORPC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pc</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;CORTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;CORDTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorerr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ORPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pss</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ORDPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">psserr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ORAPPEFF&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">appEff</span>

                        <span class="k">if</span> <span class="s1">&#39;SRTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;NRTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;ORTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span><span class="p">:</span>

                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;recalculate pss for s and n rcp&#39;</span><span class="p">)</span>
                            <span class="n">pss</span><span class="p">,</span> <span class="n">psserr</span><span class="p">,</span> <span class="n">pc</span><span class="p">,</span> <span class="n">Tcorr</span><span class="p">,</span> <span class="n">Tcorerr</span><span class="p">,</span> <span class="n">appEff</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pc_pss</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> 
                            <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;SRTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;SRDTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;NRTA&quot;</span><span class="p">],</span> 
                            <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;NRDTA&quot;</span><span class="p">],</span> <span class="n">orta</span><span class="p">,</span> <span class="n">ordta</span><span class="p">,</span> <span class="n">flux</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ORPC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pc</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;CORTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;CORDTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorerr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ORPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pss</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ORDPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">psserr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ORAPPEFF&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">appEff</span>

                        <span class="k">if</span> <span class="s1">&#39;SRTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;NRTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;ORTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span><span class="p">:</span>

                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;recalculate pss for s and o rcp&#39;</span><span class="p">)</span>
                            <span class="n">pss</span><span class="p">,</span> <span class="n">psserr</span><span class="p">,</span> <span class="n">pc</span><span class="p">,</span> <span class="n">Tcorr</span><span class="p">,</span> <span class="n">Tcorerr</span><span class="p">,</span> <span class="n">appEff</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pc_pss</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> 
                            <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;SRTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;SRDTA&quot;</span><span class="p">],</span> <span class="n">nrta</span><span class="p">,</span> <span class="n">nrdta</span><span class="p">,</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;ORTA&quot;</span><span class="p">],</span> 
                            <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;ORDTA&quot;</span><span class="p">],</span> <span class="n">flux</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ORPC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pc</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;CORTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;CORDTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorerr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ORPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pss</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ORDPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">psserr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ORAPPEFF&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">appEff</span>

                        <span class="k">if</span> <span class="s1">&#39;SRTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;NRTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;ORTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span><span class="p">:</span>

                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;recalculate pss for s rcp&#39;</span><span class="p">)</span>
                            <span class="n">pss</span><span class="p">,</span> <span class="n">psserr</span><span class="p">,</span> <span class="n">pc</span><span class="p">,</span> <span class="n">Tcorr</span><span class="p">,</span> <span class="n">Tcorerr</span><span class="p">,</span> <span class="n">appEff</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pc_pss</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> 
                            <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;SRTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;SRDTA&quot;</span><span class="p">],</span> <span class="n">nrta</span><span class="p">,</span> <span class="n">nrdta</span><span class="p">,</span> <span class="n">orta</span><span class="p">,</span> <span class="n">ordta</span><span class="p">,</span> 
                            <span class="n">flux</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ORPC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pc</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;CORTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;CORDTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorerr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ORPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pss</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ORDPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">psserr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ORAPPEFF&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">appEff</span>

                        <span class="k">if</span> <span class="s1">&#39;SRTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;NRTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;ORTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span><span class="p">:</span>

                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;recalculate pss for n and o rcp&#39;</span><span class="p">)</span>
                            <span class="n">pss</span><span class="p">,</span> <span class="n">psserr</span><span class="p">,</span> <span class="n">pc</span><span class="p">,</span> <span class="n">Tcorr</span><span class="p">,</span> <span class="n">Tcorerr</span><span class="p">,</span> <span class="n">appEff</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pc_pss</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span>
                                <span class="n">srta</span><span class="p">,</span> <span class="n">srdta</span><span class="p">,</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;NRTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;NRDTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;ORTA&quot;</span><span class="p">],</span> 
                                <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;ORDTA&quot;</span><span class="p">],</span> <span class="n">flux</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ORPC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pc</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;CORTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;CORDTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorerr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ORPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pss</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ORDPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">psserr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ORAPPEFF&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">appEff</span>

                        <span class="k">if</span> <span class="s1">&#39;SRTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;NRTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;ORTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span><span class="p">:</span>

                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;recalculate pss for o rcp&#39;</span><span class="p">)</span>
                            <span class="n">pss</span><span class="p">,</span> <span class="n">psserr</span><span class="p">,</span> <span class="n">pc</span><span class="p">,</span> <span class="n">Tcorr</span><span class="p">,</span> <span class="n">Tcorerr</span><span class="p">,</span> <span class="n">appEff</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pc_pss</span><span class="p">(</span>
                                <span class="mi">5</span><span class="p">,</span> <span class="n">srta</span><span class="p">,</span> <span class="n">srdta</span><span class="p">,</span> <span class="n">nrta</span><span class="p">,</span> <span class="n">nrdta</span><span class="p">,</span>  <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;ORTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;ORDTA&quot;</span><span class="p">],</span> 
                                <span class="n">flux</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ORPC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pc</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;CORTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;CORDTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorerr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ORPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pss</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ORDPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">psserr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ORAPPEFF&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">appEff</span>

                        <span class="k">if</span> <span class="s1">&#39;SRTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;NRTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;ORTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span><span class="p">:</span>

                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;recalculate pss for n rcp&#39;</span><span class="p">)</span>
                            <span class="n">pss</span><span class="p">,</span> <span class="n">psserr</span><span class="p">,</span> <span class="n">pc</span><span class="p">,</span> <span class="n">Tcorr</span><span class="p">,</span> <span class="n">Tcorerr</span><span class="p">,</span> <span class="n">appEff</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pc_pss</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span>
                                <span class="n">srta</span><span class="p">,</span> <span class="n">srdta</span><span class="p">,</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;NRTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;NRDTA&quot;</span><span class="p">],</span> <span class="n">orta</span><span class="p">,</span> <span class="n">ordta</span><span class="p">,</span> 
                                <span class="n">flux</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ORPC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pc</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;CORTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;CORDTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorerr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ORPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pss</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ORDPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">psserr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ORAPPEFF&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">appEff</span>

                    <span class="k">elif</span> <span class="s2">&quot;D&quot;</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;BEAMTYPE&quot;</span><span class="p">]:</span>
                        
                        <span class="n">aslta</span> <span class="o">=</span> <span class="n">databaseData</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                        <span class="n">asldta</span> <span class="o">=</span> <span class="n">databaseData</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
                        <span class="n">bslta</span> <span class="o">=</span> <span class="n">databaseData</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                        <span class="n">bsldta</span> <span class="o">=</span> <span class="n">databaseData</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>

                        <span class="n">anlta</span> <span class="o">=</span> <span class="n">databaseData</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">4</span><span class="p">]</span>
                        <span class="n">anldta</span> <span class="o">=</span> <span class="n">databaseData</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">5</span><span class="p">]</span>
                        <span class="n">bnlta</span> <span class="o">=</span> <span class="n">databaseData</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">6</span><span class="p">]</span>
                        <span class="n">bnldta</span> <span class="o">=</span> <span class="n">databaseData</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">7</span><span class="p">]</span>
                        
                        <span class="n">aolta</span> <span class="o">=</span> <span class="n">databaseData</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">8</span><span class="p">]</span>
                        <span class="n">aoldta</span> <span class="o">=</span> <span class="n">databaseData</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">9</span><span class="p">]</span>
                        <span class="n">bolta</span> <span class="o">=</span> <span class="n">databaseData</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">10</span><span class="p">]</span>
                        <span class="n">boldta</span> <span class="o">=</span> <span class="n">databaseData</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">11</span><span class="p">]</span>

                        <span class="n">asrta</span> <span class="o">=</span> <span class="n">databaseData</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">12</span><span class="p">]</span>
                        <span class="n">asrdta</span> <span class="o">=</span> <span class="n">databaseData</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">13</span><span class="p">]</span>
                        <span class="n">bsrta</span> <span class="o">=</span> <span class="n">databaseData</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">14</span><span class="p">]</span>
                        <span class="n">bsrdta</span> <span class="o">=</span> <span class="n">databaseData</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">15</span><span class="p">]</span>
                        
                        <span class="n">anrta</span> <span class="o">=</span> <span class="n">databaseData</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">16</span><span class="p">]</span>
                        <span class="n">anrdta</span> <span class="o">=</span> <span class="n">databaseData</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">17</span><span class="p">]</span>
                        <span class="n">bnrta</span> <span class="o">=</span> <span class="n">databaseData</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">18</span><span class="p">]</span>
                        <span class="n">bnrdta</span> <span class="o">=</span> <span class="n">databaseData</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">19</span><span class="p">]</span>
                        
                        <span class="n">aorta</span> <span class="o">=</span> <span class="n">databaseData</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">20</span><span class="p">]</span>
                        <span class="n">aordta</span> <span class="o">=</span> <span class="n">databaseData</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">21</span><span class="p">]</span>
                        <span class="n">borta</span> <span class="o">=</span> <span class="n">databaseData</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">22</span><span class="p">]</span>
                        <span class="n">bordta</span> <span class="o">=</span> <span class="n">databaseData</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">23</span><span class="p">]</span>

                        <span class="c1"># FOR LCP</span>
                        <span class="k">if</span> <span class="s1">&#39;ASLTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;ANLTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;AOLTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span><span class="p">:</span>

                            <span class="c1">#print(&#39;recalculate ONTA for all A BEAM lcp&#39;)</span>
                            <span class="n">pc</span><span class="p">,</span> <span class="n">Tcorr</span><span class="p">,</span> <span class="n">Tcorerr</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pc</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> 
                            <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;ASLTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;ASLDTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;ANLTA&quot;</span><span class="p">],</span> 
                            <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;ANLDTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;AOLTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;AOLDTA&quot;</span><span class="p">],</span> <span class="n">data</span><span class="p">)</span>

                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;AOLPC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pc</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ACOLTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ACOLDTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorerr</span>

                        <span class="k">if</span> <span class="s1">&#39;BSLTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;BNLTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;BOLTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span><span class="p">:</span>

                            <span class="c1">#print(&#39;recalculate pss for all B BEAM lcp&#39;)</span>
                            <span class="n">pc</span><span class="p">,</span> <span class="n">Tcorr</span><span class="p">,</span> <span class="n">Tcorerr</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pc</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;BSLTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;BSLDTA&quot;</span><span class="p">],</span> 
                            <span class="n">Dict</span><span class="p">[</span><span class="s2">&quot;BNLTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;BNLDTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;BOLTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;BOLDTA&quot;</span><span class="p">],</span> 
                            <span class="n">data</span><span class="p">)</span>

                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BOLPC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pc</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BCOLTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BCOLDTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorerr</span>


                        <span class="k">if</span> <span class="s1">&#39;ASLTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;ANLTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;AOLTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span><span class="p">:</span>

                            <span class="c1">#print(&#39;recalculate pss for A BEAM hps and hpn lcp&#39;)</span>
                            <span class="n">pc</span><span class="p">,</span> <span class="n">Tcorr</span><span class="p">,</span> <span class="n">Tcorerr</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pc</span><span class="p">(</span> <span class="mi">2</span><span class="p">,</span> 
                            <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;ASLTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;ASLDTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;ANLTA&quot;</span><span class="p">],</span> 
                            <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;ANLDTA&quot;</span><span class="p">],</span> <span class="n">aolta</span><span class="p">,</span> <span class="n">aoldta</span><span class="p">,</span>  <span class="n">data</span><span class="p">)</span>

                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;AOLPC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pc</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ACOLTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ACOLDTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorerr</span>

                        <span class="k">if</span> <span class="s1">&#39;BSLTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;BNLTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;BOLTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span><span class="p">:</span>

                            <span class="c1">#print(&#39;recalculate pss for B BEAM hps and hpn lcp&#39;)</span>
                            <span class="n">pc</span><span class="p">,</span> <span class="n">Tcorr</span><span class="p">,</span> <span class="n">Tcorerr</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pc</span><span class="p">(</span>
                                <span class="mi">2</span><span class="p">,</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;BSLTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;BSLDTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;BNLTA&quot;</span><span class="p">],</span> 
                                <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;BNLDTA&quot;</span><span class="p">],</span> <span class="n">bolta</span><span class="p">,</span> <span class="n">boldta</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BOLPC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pc</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BCOLTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BCOLDTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorerr</span>


                        <span class="k">if</span> <span class="s1">&#39;ASLTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;ANLTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;AOLTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span><span class="p">:</span>

                            <span class="c1">#print(&#39;recalculate pss for A BEAM s and o lcp&#39;)</span>
                            <span class="n">pc</span><span class="p">,</span> <span class="n">Tcorr</span><span class="p">,</span> <span class="n">Tcorerr</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pc</span><span class="p">(</span>
                                <span class="mi">2</span><span class="p">,</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;ASLTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;ASLDTA&quot;</span><span class="p">],</span> <span class="n">anlta</span><span class="p">,</span> <span class="n">anldta</span><span class="p">,</span> 
                                <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;AOLTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;AOLDTA&quot;</span><span class="p">],</span> <span class="n">data</span><span class="p">)</span>

                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;AOLPC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pc</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ACOLTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ACOLDTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorerr</span>

                        <span class="k">if</span> <span class="s1">&#39;BSLTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;BNLTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;BOLTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span><span class="p">:</span>

                            <span class="c1">#print(&#39;recalculate pss for B BEAM s and o lcp&#39;)</span>
                            <span class="n">pc</span><span class="p">,</span> <span class="n">Tcorr</span><span class="p">,</span> <span class="n">Tcorerr</span><span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pc</span><span class="p">(</span>
                                <span class="mi">2</span><span class="p">,</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;BSLTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;BSLDTA&quot;</span><span class="p">],</span> <span class="n">bnlta</span><span class="p">,</span> <span class="n">bnldta</span><span class="p">,</span> 
                                <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;BOLTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;BOLDTA&quot;</span><span class="p">],</span> <span class="n">data</span><span class="p">)</span>

                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BOLPC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pc</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BCOLTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BCOLDTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorerr</span>


                        <span class="k">if</span> <span class="s1">&#39;ASLTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;ANLTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;AOLTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span><span class="p">:</span>

                            <span class="c1">#print(&#39;recalculate pss for A BEAM s lcp&#39;)</span>
                            <span class="n">pc</span><span class="p">,</span> <span class="n">Tcorr</span><span class="p">,</span> <span class="n">Tcorerr</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pc</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> 
                            <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;ASLTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;ASLDTA&quot;</span><span class="p">],</span> <span class="n">anlta</span><span class="p">,</span> <span class="n">anldta</span><span class="p">,</span> 
                            <span class="n">aolta</span><span class="p">,</span> <span class="n">aoldta</span><span class="p">,</span>  <span class="n">data</span><span class="p">)</span>

                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;AOLPC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pc</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ACOLTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ACOLDTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorerr</span>

                        <span class="k">if</span> <span class="s1">&#39;BSLTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;BNLTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;BOLTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span><span class="p">:</span>

                            <span class="c1">#print(&#39;recalculate pss for B BEAM s lcp&#39;)</span>
                            <span class="n">pc</span><span class="p">,</span> <span class="n">Tcorr</span><span class="p">,</span> <span class="n">Tcorerr</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pc</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> 
                            <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;BSLTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;BSLDTA&quot;</span><span class="p">],</span> <span class="n">bnlta</span><span class="p">,</span> <span class="n">bnldta</span><span class="p">,</span> 
                            <span class="n">bolta</span><span class="p">,</span> <span class="n">boldta</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BOLPC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pc</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BCOLTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BCOLDTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorerr</span>


                        <span class="k">if</span> <span class="s1">&#39;ASLTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;ANLTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;AOLTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span><span class="p">:</span>

                            <span class="c1">#print(&#39;recalculate A BEAM pss for n lcp&#39;)</span>
                            <span class="n">pc</span><span class="p">,</span> <span class="n">Tcorr</span><span class="p">,</span> <span class="n">Tcorerr</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pc</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span>
                            <span class="n">aslta</span><span class="p">,</span> <span class="n">asldta</span><span class="p">,</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;ANLTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;ANLDTA&quot;</span><span class="p">],</span> 
                            <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;AOLTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;AOLDTA&quot;</span><span class="p">],</span>  <span class="n">data</span><span class="p">)</span>

                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;AOLPC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pc</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ACOLTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ACOLDTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorerr</span>

                        <span class="k">if</span> <span class="s1">&#39;BSLTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;BNLTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;BOLTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span><span class="p">:</span>

                            <span class="c1">#print(&#39;recalculate B BEAM pss for n lcp&#39;)</span>
                            <span class="n">pc</span><span class="p">,</span> <span class="n">Tcorr</span><span class="p">,</span> <span class="n">Tcorerr</span><span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pc</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span>
                            <span class="n">bslta</span><span class="p">,</span> <span class="n">bsldta</span><span class="p">,</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;BNLTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;BNLDTA&quot;</span><span class="p">],</span> 
                            <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;BOLTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;BOLDTA&quot;</span><span class="p">],</span> <span class="n">data</span><span class="p">)</span>

                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BOLPC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pc</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BCOLTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BCOLDTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorerr</span>


                        <span class="k">if</span> <span class="s1">&#39;ASLTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;ANLTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;AOLTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span><span class="p">:</span>

                            <span class="c1">#print(&#39;recalculate A BEAM pss for o lcp&#39;)</span>
                            <span class="n">pc</span><span class="p">,</span> <span class="n">Tcorr</span><span class="p">,</span> <span class="n">Tcorerr</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pc</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span>
                            <span class="n">aslta</span><span class="p">,</span> <span class="n">asldta</span><span class="p">,</span> <span class="n">anlta</span><span class="p">,</span> <span class="n">anldta</span><span class="p">,</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;AOLTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;AOLDTA&quot;</span><span class="p">],</span> 
                            <span class="n">data</span><span class="p">)</span>

                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;AOLPC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pc</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ACOLTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ACOLDTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorerr</span>

                        <span class="k">if</span> <span class="s1">&#39;BSLTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;BNLTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;BOLTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span><span class="p">:</span>

                            <span class="c1">#print(&#39;recalculate pss for o lcp&#39;)</span>
                            <span class="n">pc</span><span class="p">,</span> <span class="n">Tcorr</span><span class="p">,</span> <span class="n">Tcorerr</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pc</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span>
                            <span class="n">bslta</span><span class="p">,</span> <span class="n">bsldta</span><span class="p">,</span> <span class="n">bnlta</span><span class="p">,</span> <span class="n">bnldta</span><span class="p">,</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;BOLTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;BOLDTA&quot;</span><span class="p">],</span> 
                            <span class="n">data</span><span class="p">)</span>

                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BOLPC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pc</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BCOLTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BCOLDTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorerr</span>


                        <span class="k">if</span> <span class="s1">&#39;ASLTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;ANLTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;AOLTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span><span class="p">:</span>

                            <span class="c1">#print(&#39;recalculate A BEAM pss for s and o lcp&#39;)</span>
                            <span class="n">pc</span><span class="p">,</span> <span class="n">Tcorr</span><span class="p">,</span> <span class="n">Tcorerr</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pc</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span>
                            <span class="n">aslta</span><span class="p">,</span> <span class="n">asldta</span><span class="p">,</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;ANLTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;ANLDTA&quot;</span><span class="p">],</span> 
                            <span class="n">aolta</span><span class="p">,</span> <span class="n">aoldta</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;AOLPC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pc</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ACOLTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ACOLDTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorerr</span>

                        <span class="k">if</span> <span class="s1">&#39;BSLTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;BNLTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;BOLTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span><span class="p">:</span>

                            <span class="c1">#print(&#39;recalculate B BEAM pss for s and o lcp&#39;)</span>
                            <span class="n">pc</span><span class="p">,</span> <span class="n">Tcorr</span><span class="p">,</span> <span class="n">Tcorerr</span><span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pc</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span>
                            <span class="n">bslta</span><span class="p">,</span> <span class="n">bsldta</span><span class="p">,</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;BNLTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;BNLDTA&quot;</span><span class="p">],</span> 
                            <span class="n">bolta</span><span class="p">,</span> <span class="n">boldta</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BOLPC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pc</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BCOLTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BCOLDTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorerr</span>


                        <span class="c1"># FOR RCP</span>
                        <span class="k">if</span> <span class="s1">&#39;ASRTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;ANRTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;AORTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span><span class="p">:</span>

                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;recalculate pss for all A BEAM rcp&#39;</span><span class="p">)</span>
                            <span class="n">pc</span><span class="p">,</span> <span class="n">Tcorr</span><span class="p">,</span> <span class="n">Tcorerr</span><span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pc</span><span class="p">(</span>
                                <span class="mi">2</span><span class="p">,</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;ASRTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;ASRDTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;ANRTA&quot;</span><span class="p">],</span> 
                                <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;ANRDTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;AORTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;AORDTA&quot;</span><span class="p">],</span> 
                                 <span class="n">data</span><span class="p">)</span>

                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;AORPC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pc</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ACORTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ACORDTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorerr</span>

                        <span class="k">if</span> <span class="s1">&#39;BSRTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;BNRTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;BORTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span><span class="p">:</span>

                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;recalculate pss for all B BEAM rcp&#39;</span><span class="p">)</span>
                            <span class="n">pc</span><span class="p">,</span> <span class="n">Tcorr</span><span class="p">,</span> <span class="n">Tcorerr</span><span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pc</span><span class="p">(</span>
                                <span class="mi">2</span><span class="p">,</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;BSRTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;BSRDTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;BNRTA&quot;</span><span class="p">],</span> 
                                <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;BNRDTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;BORTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;BORDTA&quot;</span><span class="p">],</span> 
                                <span class="n">data</span><span class="p">)</span>

                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BORPC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pc</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BCORTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BCORDTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorerr</span>

                        
                        <span class="k">if</span> <span class="s1">&#39;ASRTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;ANRTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;AORTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span><span class="p">:</span>

                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;recalculate pss for A BEAM hps and hpn rcp&#39;</span><span class="p">)</span>
                            <span class="n">pc</span><span class="p">,</span> <span class="n">Tcorr</span><span class="p">,</span> <span class="n">Tcorerr</span><span class="p">,</span> <span class="n">appEff</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pc</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;ASRTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;ASRDTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;ANRTA&quot;</span><span class="p">],</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;ANRDTA&quot;</span><span class="p">],</span> <span class="n">aorta</span><span class="p">,</span> <span class="n">aordta</span><span class="p">,</span><span class="n">data</span><span class="p">)</span>

                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;AORPC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pc</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ACORTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ACORDTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorerr</span>

                        <span class="k">if</span> <span class="s1">&#39;BSRTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;BNRTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;BORTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span><span class="p">:</span>

                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;recalculate pss for B BEAM hps and hpn rcp&#39;</span><span class="p">)</span>
                            <span class="n">pc</span><span class="p">,</span> <span class="n">Tcorr</span><span class="p">,</span> <span class="n">Tcorerr</span><span class="p">,</span> <span class="n">appEff</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pc</span><span class="p">(</span>
                                <span class="mi">2</span><span class="p">,</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;BSRTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;BSRDTA&quot;</span><span class="p">],</span> 
                                <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;BNRTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;BNRDTA&quot;</span><span class="p">],</span> <span class="n">borta</span><span class="p">,</span> <span class="n">bordta</span><span class="p">,</span>  <span class="n">data</span><span class="p">)</span>

                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BORPC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pc</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BCORTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BCORDTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorerr</span>

                        
                        <span class="k">if</span> <span class="s1">&#39;ASRTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;ANRTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;AORTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span><span class="p">:</span>

                            <span class="c1">#print(&#39;recalculate pss for A BEAM s and o rcp&#39;)</span>
                            <span class="n">pc</span><span class="p">,</span> <span class="n">Tcorr</span><span class="p">,</span> <span class="n">Tcorerr</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pc</span><span class="p">(</span>
                                <span class="mi">2</span><span class="p">,</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;ASRTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;ASRDTA&quot;</span><span class="p">],</span> <span class="n">anrta</span><span class="p">,</span> <span class="n">anrdta</span><span class="p">,</span>
                                <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;AORTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;AORDTA&quot;</span><span class="p">],</span> <span class="n">data</span><span class="p">)</span>

                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;AORPC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pc</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ACORTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ACORDTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorerr</span>

                        <span class="k">if</span> <span class="s1">&#39;BSRTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;BNRTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;BORTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span><span class="p">:</span>

                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;recalculate pss for B BEAM s and o rcp&#39;</span><span class="p">)</span>
                            <span class="n">pc</span><span class="p">,</span> <span class="n">Tcorr</span><span class="p">,</span> <span class="n">Tcorerr</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pc</span><span class="p">(</span>
                                <span class="mi">2</span><span class="p">,</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;BSRTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;BSRDTA&quot;</span><span class="p">],</span> <span class="n">bnrta</span><span class="p">,</span> <span class="n">bnrdta</span><span class="p">,</span>
                                <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;BORTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;BORDTA&quot;</span><span class="p">],</span> <span class="n">data</span><span class="p">)</span>

                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BORPC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pc</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BCORTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BCORDTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorerr</span>


                        <span class="k">if</span> <span class="s1">&#39;ASRTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;ANRTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;AORTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span><span class="p">:</span>

                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;recalculate pss for A BEAM s rcp&#39;</span><span class="p">)</span>
                            <span class="n">pc</span><span class="p">,</span> <span class="n">Tcorr</span><span class="p">,</span> <span class="n">Tcorerr</span><span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pc</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span>
                                <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;ASRTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;ASRDTA&quot;</span><span class="p">],</span> <span class="n">anrta</span><span class="p">,</span> <span class="n">anrdta</span><span class="p">,</span>
                                <span class="n">aorta</span><span class="p">,</span> <span class="n">aordta</span><span class="p">,</span>  <span class="n">data</span><span class="p">)</span>

                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;AORPC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pc</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ACORTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ACORDTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorerr</span>

                        <span class="k">if</span> <span class="s1">&#39;BSRTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;BNRTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;BORTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span><span class="p">:</span>

                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;recalculate pss for B BEAM s rcp&#39;</span><span class="p">)</span>
                            <span class="n">pc</span><span class="p">,</span> <span class="n">Tcorr</span><span class="p">,</span> <span class="n">Tcorerr</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pc</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span>
                                <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;BSRTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;BSRDTA&quot;</span><span class="p">],</span> <span class="n">bnrta</span><span class="p">,</span> <span class="n">bnrdta</span><span class="p">,</span>
                                <span class="n">borta</span><span class="p">,</span> <span class="n">bordta</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BORPC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pc</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BCORTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BCORDTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorerr</span>


                        <span class="k">if</span> <span class="s1">&#39;ASRTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;ANRTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;AORTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span><span class="p">:</span>

                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;recalculate A BEAM pss for n rcp&#39;</span><span class="p">)</span>
                            <span class="n">pc</span><span class="p">,</span> <span class="n">Tcorr</span><span class="p">,</span> <span class="n">Tcorerr</span><span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pc</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span>
                                <span class="n">asrta</span><span class="p">,</span> <span class="n">asrdta</span><span class="p">,</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;ANRTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;ANRDTA&quot;</span><span class="p">],</span>
                                <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;AORTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;AORDTA&quot;</span><span class="p">],</span> <span class="n">data</span><span class="p">)</span>

                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;AORPC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pc</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ACORTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ACORDTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorerr</span>

                        <span class="k">if</span> <span class="s1">&#39;BSRTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;BNRTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;BORTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span><span class="p">:</span>

                            <span class="c1">#print(&#39;recalculate B BEAM pss for n rcp&#39;)</span>
                            <span class="n">pc</span><span class="p">,</span> <span class="n">Tcorr</span><span class="p">,</span> <span class="n">Tcorerr</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pc</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span>
                                <span class="n">bsrta</span><span class="p">,</span> <span class="n">bsrdta</span><span class="p">,</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;BNRTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;BNRDTA&quot;</span><span class="p">],</span>
                                <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;BORTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;BORDTA&quot;</span><span class="p">],</span>  <span class="n">data</span><span class="p">)</span>

                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BORPC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pc</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BCORTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BCORDTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorerr</span>


                        <span class="k">if</span> <span class="s1">&#39;ASRTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;ANRTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;AORTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span><span class="p">:</span>

                            <span class="c1">#print(&#39;recalculate A BEAM pss for o rcp&#39;)</span>
                            <span class="n">pc</span><span class="p">,</span> <span class="n">Tcorr</span><span class="p">,</span> <span class="n">Tcorerr</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pc</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span>
                                <span class="n">asrta</span><span class="p">,</span> <span class="n">asrdta</span><span class="p">,</span> <span class="n">anrta</span><span class="p">,</span> <span class="n">anrdta</span><span class="p">,</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;AORTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;AORDTA&quot;</span><span class="p">],</span>
                                <span class="n">data</span><span class="p">)</span>

                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;AORPC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pc</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ACORTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ACORDTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorerr</span>

                        <span class="k">if</span> <span class="s1">&#39;BSRTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;BNRTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;BORTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span><span class="p">:</span>

                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;recalculate pss for B BEAM o rcp&#39;</span><span class="p">)</span>
                            <span class="n">pc</span><span class="p">,</span> <span class="n">Tcorr</span><span class="p">,</span> <span class="n">Tcorerr</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pc</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span>
                                <span class="n">bsrta</span><span class="p">,</span> <span class="n">bsrdta</span><span class="p">,</span> <span class="n">bnrta</span><span class="p">,</span> <span class="n">bnrdta</span><span class="p">,</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;BORTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;BORDTA&quot;</span><span class="p">],</span>
                                <span class="n">data</span><span class="p">)</span>

                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BORPC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pc</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BCORTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BCORDTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorerr</span>


                        <span class="k">if</span> <span class="s1">&#39;ASRTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;ANRTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;AORTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span><span class="p">:</span>

                            <span class="c1">#print(&#39;recalculate A BEAM pss for s and o rcp&#39;)</span>
                            <span class="n">pc</span><span class="p">,</span> <span class="n">Tcorr</span><span class="p">,</span> <span class="n">Tcorerr</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pc</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span>
                                <span class="n">asrta</span><span class="p">,</span> <span class="n">asrdta</span><span class="p">,</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;ANRTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;ANRDTA&quot;</span><span class="p">],</span>
                                <span class="n">aorta</span><span class="p">,</span> <span class="n">aordta</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;AORPC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pc</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ACORTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ACORDTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorerr</span>

                        <span class="k">if</span> <span class="s1">&#39;BSRTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;BNRTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;BORTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span><span class="p">:</span>

                            <span class="c1">#print(&#39;recalculate B BEAM pss for s and o rcp&#39;)</span>
                            <span class="n">pc</span><span class="p">,</span> <span class="n">Tcorr</span><span class="p">,</span> <span class="n">Tcorerr</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pc</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span>
                                <span class="n">bsrta</span><span class="p">,</span> <span class="n">bsrdta</span><span class="p">,</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;BNRTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;BNRDTA&quot;</span><span class="p">],</span>
                                <span class="n">borta</span><span class="p">,</span> <span class="n">bordta</span><span class="p">,</span>  <span class="n">data</span><span class="p">)</span>

                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BORPC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pc</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BCORTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BCORDTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorerr</span>

                <span class="k">else</span><span class="p">:</span>

                    <span class="k">if</span> <span class="s2">&quot;CAL&quot;</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;OBJECTTYPE&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;OBJECT&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;JUPITER&quot;</span><span class="p">:</span>
                        <span class="n">stmt</span> <span class="o">=</span> <span class="s2">&quot;SELECT TOTAL_PLANET_FLUX_D,&quot;</span><span class="o">+</span><span class="n">dbKeys</span><span class="o">+</span><span class="s2">&quot; FROM &quot;</span><span class="o">+</span><span class="n">table</span> <span class="o">+</span> \
                            <span class="s1">&#39; WHERE FILENAME = &quot;&#39;</span> <span class="o">+</span> <span class="n">filename</span><span class="o">+</span><span class="s1">&#39;&quot; ;&#39;</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">stmt</span> <span class="o">=</span> <span class="s2">&quot;SELECT FLUX,&quot;</span><span class="o">+</span><span class="n">dbKeys</span><span class="o">+</span><span class="s2">&quot; FROM &quot;</span><span class="o">+</span><span class="n">table</span> <span class="o">+</span> \
                            <span class="s1">&#39; WHERE FILENAME = &quot;&#39;</span> <span class="o">+</span> <span class="n">filename</span><span class="o">+</span><span class="s1">&#39;&quot; ;&#39;</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">stmt</span><span class="p">)</span>
                    <span class="n">databaseData</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>

                    <span class="k">if</span> <span class="s2">&quot;S&quot;</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;BEAMTYPE&#39;</span><span class="p">]:</span>
                        <span class="n">flux</span> <span class="o">=</span> <span class="n">databaseData</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                        <span class="n">slta</span> <span class="o">=</span> <span class="n">databaseData</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
                        <span class="n">sldta</span> <span class="o">=</span> <span class="n">databaseData</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                        <span class="n">nlta</span> <span class="o">=</span> <span class="n">databaseData</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
                        <span class="n">nldta</span> <span class="o">=</span> <span class="n">databaseData</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">4</span><span class="p">]</span>
                        <span class="n">olta</span> <span class="o">=</span> <span class="n">databaseData</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">5</span><span class="p">]</span>
                        <span class="n">oldta</span> <span class="o">=</span> <span class="n">databaseData</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">6</span><span class="p">]</span>
                        <span class="n">srta</span> <span class="o">=</span> <span class="n">databaseData</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">7</span><span class="p">]</span>
                        <span class="n">srdta</span> <span class="o">=</span> <span class="n">databaseData</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">8</span><span class="p">]</span>
                        <span class="n">nrta</span> <span class="o">=</span> <span class="n">databaseData</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">9</span><span class="p">]</span>
                        <span class="n">nrdta</span> <span class="o">=</span> <span class="n">databaseData</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">10</span><span class="p">]</span>
                        <span class="n">orta</span> <span class="o">=</span> <span class="n">databaseData</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">11</span><span class="p">]</span>
                        <span class="n">ordta</span> <span class="o">=</span> <span class="n">databaseData</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">12</span><span class="p">]</span>

                        <span class="c1"># FOR LCP</span>
                        <span class="k">if</span> <span class="s1">&#39;SLTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;NLTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;OLTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span><span class="p">:</span>

                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;recalculate pss for all lcp&#39;</span><span class="p">)</span>
                            <span class="n">pss</span><span class="p">,</span> <span class="n">psserr</span><span class="p">,</span> <span class="n">pc</span><span class="p">,</span> <span class="n">Tcorr</span><span class="p">,</span> <span class="n">Tcorerr</span><span class="p">,</span> <span class="n">appEff</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pc_pss</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> 
                            <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;SLTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;SLDTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;NLTA&quot;</span><span class="p">],</span> 
                            <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;NLDTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;OLTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;OLDTA&quot;</span><span class="p">],</span> <span class="n">flux</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;OLPC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pc</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;COLTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;COLDTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorerr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;OLPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pss</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;OLDPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">psserr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;OLAPPEFF&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">appEff</span>

                        <span class="k">if</span> <span class="s1">&#39;SLTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;NLTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;OLTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span><span class="p">:</span>

                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;recalculate pss for hps and hpn lcp&#39;</span><span class="p">)</span>
                            <span class="n">pss</span><span class="p">,</span> <span class="n">psserr</span><span class="p">,</span> <span class="n">pc</span><span class="p">,</span> <span class="n">Tcorr</span><span class="p">,</span> <span class="n">Tcorerr</span><span class="p">,</span> <span class="n">appEff</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pc_pss</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span>
                                <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;SLTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;SLDTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;NLTA&quot;</span><span class="p">],</span> 
                                <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;NLDTA&quot;</span><span class="p">],</span> <span class="n">olta</span><span class="p">,</span> <span class="n">oldta</span><span class="p">,</span> <span class="n">flux</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;OLPC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pc</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;COLTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;COLDTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorerr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;OLPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pss</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;OLDPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">psserr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;OLAPPEFF&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">appEff</span>

                        <span class="k">if</span> <span class="s1">&#39;SLTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;NLTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;OLTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span><span class="p">:</span>

                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;recalculate pss for s and o lcp&#39;</span><span class="p">)</span>
                            <span class="n">pss</span><span class="p">,</span> <span class="n">psserr</span><span class="p">,</span> <span class="n">pc</span><span class="p">,</span> <span class="n">Tcorr</span><span class="p">,</span> <span class="n">Tcorerr</span><span class="p">,</span> <span class="n">appEff</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pc_pss</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> 
                            <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;SLTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;SLDTA&quot;</span><span class="p">],</span> <span class="n">nlta</span><span class="p">,</span> <span class="n">nldta</span><span class="p">,</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;OLTA&quot;</span><span class="p">],</span> 
                            <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;OLDTA&quot;</span><span class="p">],</span> <span class="n">flux</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;OLPC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pc</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;COLTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;COLDTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorerr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;OLPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pss</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;OLDPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">psserr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;OLAPPEFF&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">appEff</span>

                        <span class="k">if</span> <span class="s1">&#39;SLTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;NLTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;OLTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span><span class="p">:</span>

                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;recalculate pss for s lcp&#39;</span><span class="p">)</span>
                            <span class="n">pss</span><span class="p">,</span> <span class="n">psserr</span><span class="p">,</span> <span class="n">pc</span><span class="p">,</span> <span class="n">Tcorr</span><span class="p">,</span> <span class="n">Tcorerr</span><span class="p">,</span> <span class="n">appEff</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pc_pss</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span>
                                <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;SLTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;SLDTA&quot;</span><span class="p">],</span> <span class="n">nlta</span><span class="p">,</span> <span class="n">nldta</span><span class="p">,</span> <span class="n">olta</span><span class="p">,</span> <span class="n">oldta</span><span class="p">,</span> 
                                <span class="n">flux</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;OLPC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pc</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;COLTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;COLDTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorerr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;OLPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pss</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;OLDPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">psserr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;OLAPPEFF&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">appEff</span>
                            
                        <span class="k">if</span> <span class="s1">&#39;SLTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;NLTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;OLTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span><span class="p">:</span>

                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;recalculate pss for n lcp&#39;</span><span class="p">)</span>
                            <span class="n">pss</span><span class="p">,</span> <span class="n">psserr</span><span class="p">,</span> <span class="n">pc</span><span class="p">,</span> <span class="n">Tcorr</span><span class="p">,</span> <span class="n">Tcorerr</span><span class="p">,</span> <span class="n">appEff</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pc_pss</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span>
                                <span class="n">slta</span><span class="p">,</span> <span class="n">sldta</span><span class="p">,</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;NLTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;NLDTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;OLTA&quot;</span><span class="p">],</span> 
                                <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;OLDTA&quot;</span><span class="p">],</span> <span class="n">flux</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;OLPC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pc</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;COLTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;COLDTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorerr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;OLPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pss</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;OLDPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">psserr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;OLAPPEFF&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">appEff</span>

                        <span class="k">if</span> <span class="s1">&#39;SLTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;NLTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;OLTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span><span class="p">:</span>

                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;recalculate pss for o lcp&#39;</span><span class="p">)</span>
                            <span class="n">pss</span><span class="p">,</span> <span class="n">psserr</span><span class="p">,</span> <span class="n">pc</span><span class="p">,</span> <span class="n">Tcorr</span><span class="p">,</span> <span class="n">Tcorerr</span><span class="p">,</span> <span class="n">appEff</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pc_pss</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span>
                                <span class="n">slta</span><span class="p">,</span> <span class="n">sldta</span><span class="p">,</span> <span class="n">nlta</span><span class="p">,</span> <span class="n">nldta</span><span class="p">,</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;OLTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;OLDTA&quot;</span><span class="p">],</span> 
                                <span class="n">flux</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;OLPC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pc</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;COLTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;COLDTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorerr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;OLPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pss</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;OLDPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">psserr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;OLAPPEFF&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">appEff</span>

                        <span class="k">if</span> <span class="s1">&#39;SLTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;NLTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;OLTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span><span class="p">:</span>

                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;recalculate pss for s and o lcp&#39;</span><span class="p">)</span>
                            <span class="n">pss</span><span class="p">,</span> <span class="n">psserr</span><span class="p">,</span> <span class="n">pc</span><span class="p">,</span> <span class="n">Tcorr</span><span class="p">,</span> <span class="n">Tcorerr</span><span class="p">,</span> <span class="n">appEff</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pc_pss</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span>
                                <span class="n">slta</span><span class="p">,</span> <span class="n">sldta</span><span class="p">,</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;NLTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;NLDTA&quot;</span><span class="p">],</span> <span class="n">olta</span><span class="p">,</span> <span class="n">oldta</span><span class="p">,</span> 
                                <span class="n">flux</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;OLPC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pc</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;COLTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;COLDTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorerr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;OLPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pss</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;OLDPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">psserr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;OLAPPEFF&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">appEff</span>

                        <span class="c1"># FOR RCP</span>
                        <span class="k">if</span> <span class="s1">&#39;SRTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;NRTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;ORTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span><span class="p">:</span>

                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;recalculate pss for all rcp&#39;</span><span class="p">)</span>
                            <span class="n">pss</span><span class="p">,</span> <span class="n">psserr</span><span class="p">,</span> <span class="n">pc</span><span class="p">,</span> <span class="n">Tcorr</span><span class="p">,</span> <span class="n">Tcorerr</span><span class="p">,</span> <span class="n">appEff</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pc_pss</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span>
                                <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;SRTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;SRDTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;NRTA&quot;</span><span class="p">],</span> 
                                <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;NRDTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;ORTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;ORDTA&quot;</span><span class="p">],</span> 
                                <span class="n">flux</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ORPC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pc</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;CORTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;CORDTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorerr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ORPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pss</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ORDPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">psserr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ORAPPEFF&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">appEff</span>

                        <span class="k">if</span> <span class="s1">&#39;SRTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;NRTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;ORTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span><span class="p">:</span>

                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;recalculate pss for s and n rcp&#39;</span><span class="p">)</span>
                            <span class="n">pss</span><span class="p">,</span> <span class="n">psserr</span><span class="p">,</span> <span class="n">pc</span><span class="p">,</span> <span class="n">Tcorr</span><span class="p">,</span> <span class="n">Tcorerr</span><span class="p">,</span> <span class="n">appEff</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pc_pss</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> 
                            <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;SRTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;SRDTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;NRTA&quot;</span><span class="p">],</span> 
                            <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;NRDTA&quot;</span><span class="p">],</span> <span class="n">orta</span><span class="p">,</span> <span class="n">ordta</span><span class="p">,</span> <span class="n">flux</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ORPC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pc</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;CORTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;CORDTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorerr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ORPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pss</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ORDPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">psserr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ORAPPEFF&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">appEff</span>

                        <span class="k">if</span> <span class="s1">&#39;SRTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;NRTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;ORTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span><span class="p">:</span>

                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;recalculate pss for s and o rcp&#39;</span><span class="p">)</span>
                            <span class="n">pss</span><span class="p">,</span> <span class="n">psserr</span><span class="p">,</span> <span class="n">pc</span><span class="p">,</span> <span class="n">Tcorr</span><span class="p">,</span> <span class="n">Tcorerr</span><span class="p">,</span> <span class="n">appEff</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pc_pss</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> 
                            <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;SRTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;SRDTA&quot;</span><span class="p">],</span> <span class="n">nrta</span><span class="p">,</span> <span class="n">nrdta</span><span class="p">,</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;ORTA&quot;</span><span class="p">],</span> 
                            <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;ORDTA&quot;</span><span class="p">],</span> <span class="n">flux</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ORPC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pc</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;CORTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;CORDTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorerr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ORPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pss</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ORDPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">psserr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ORAPPEFF&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">appEff</span>

                        <span class="k">if</span> <span class="s1">&#39;SRTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;NRTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;ORTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span><span class="p">:</span>

                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;recalculate pss for s rcp&#39;</span><span class="p">)</span>
                            <span class="n">pss</span><span class="p">,</span> <span class="n">psserr</span><span class="p">,</span> <span class="n">pc</span><span class="p">,</span> <span class="n">Tcorr</span><span class="p">,</span> <span class="n">Tcorerr</span><span class="p">,</span> <span class="n">appEff</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pc_pss</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> 
                            <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;SRTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;SRDTA&quot;</span><span class="p">],</span> <span class="n">nrta</span><span class="p">,</span> <span class="n">nrdta</span><span class="p">,</span> <span class="n">orta</span><span class="p">,</span> <span class="n">ordta</span><span class="p">,</span> 
                            <span class="n">flux</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ORPC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pc</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;CORTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;CORDTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorerr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ORPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pss</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ORDPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">psserr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ORAPPEFF&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">appEff</span>

                        <span class="k">if</span> <span class="s1">&#39;SRTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;NRTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;ORTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span><span class="p">:</span>

                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;recalculate pss for n and o rcp&#39;</span><span class="p">)</span>
                            <span class="n">pss</span><span class="p">,</span> <span class="n">psserr</span><span class="p">,</span> <span class="n">pc</span><span class="p">,</span> <span class="n">Tcorr</span><span class="p">,</span> <span class="n">Tcorerr</span><span class="p">,</span> <span class="n">appEff</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pc_pss</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span>
                                <span class="n">srta</span><span class="p">,</span> <span class="n">srdta</span><span class="p">,</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;NRTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;NRDTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;ORTA&quot;</span><span class="p">],</span> 
                                <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;ORDTA&quot;</span><span class="p">],</span> <span class="n">flux</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ORPC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pc</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;CORTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;CORDTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorerr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ORPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pss</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ORDPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">psserr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ORAPPEFF&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">appEff</span>

                        <span class="k">if</span> <span class="s1">&#39;SRTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;NRTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;ORTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span><span class="p">:</span>

                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;recalculate pss for o rcp&#39;</span><span class="p">)</span>
                            <span class="n">pss</span><span class="p">,</span> <span class="n">psserr</span><span class="p">,</span> <span class="n">pc</span><span class="p">,</span> <span class="n">Tcorr</span><span class="p">,</span> <span class="n">Tcorerr</span><span class="p">,</span> <span class="n">appEff</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pc_pss</span><span class="p">(</span>
                                <span class="mi">5</span><span class="p">,</span> <span class="n">srta</span><span class="p">,</span> <span class="n">srdta</span><span class="p">,</span> <span class="n">nrta</span><span class="p">,</span> <span class="n">nrdta</span><span class="p">,</span>  <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;ORTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;ORDTA&quot;</span><span class="p">],</span> 
                                <span class="n">flux</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ORPC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pc</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;CORTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;CORDTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorerr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ORPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pss</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ORDPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">psserr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ORAPPEFF&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">appEff</span>

                        <span class="k">if</span> <span class="s1">&#39;SRTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;NRTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;ORTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span><span class="p">:</span>

                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;recalculate pss for n rcp&#39;</span><span class="p">)</span>
                            <span class="n">pss</span><span class="p">,</span> <span class="n">psserr</span><span class="p">,</span> <span class="n">pc</span><span class="p">,</span> <span class="n">Tcorr</span><span class="p">,</span> <span class="n">Tcorerr</span><span class="p">,</span> <span class="n">appEff</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pc_pss</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span>
                                <span class="n">srta</span><span class="p">,</span> <span class="n">srdta</span><span class="p">,</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;NRTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;NRDTA&quot;</span><span class="p">],</span> <span class="n">orta</span><span class="p">,</span> <span class="n">ordta</span><span class="p">,</span> 
                                <span class="n">flux</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ORPC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pc</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;CORTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;CORDTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorerr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ORPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pss</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ORDPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">psserr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ORAPPEFF&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">appEff</span>

                    <span class="k">elif</span> <span class="s2">&quot;D&quot;</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;BEAMTYPE&quot;</span><span class="p">]:</span>
                        
                        <span class="n">flux</span> <span class="o">=</span> <span class="n">databaseData</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                        <span class="n">aslta</span> <span class="o">=</span> <span class="n">databaseData</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
                        <span class="n">asldta</span> <span class="o">=</span> <span class="n">databaseData</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                        <span class="n">bslta</span> <span class="o">=</span> <span class="n">databaseData</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
                        <span class="n">bsldta</span> <span class="o">=</span> <span class="n">databaseData</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">4</span><span class="p">]</span>
                        <span class="n">anlta</span> <span class="o">=</span> <span class="n">databaseData</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">5</span><span class="p">]</span>
                        <span class="n">anldta</span> <span class="o">=</span> <span class="n">databaseData</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">6</span><span class="p">]</span>
                        <span class="n">bnlta</span> <span class="o">=</span> <span class="n">databaseData</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">7</span><span class="p">]</span>
                        <span class="n">bnldta</span> <span class="o">=</span> <span class="n">databaseData</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">8</span><span class="p">]</span>
                        <span class="n">aolta</span> <span class="o">=</span> <span class="n">databaseData</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">9</span><span class="p">]</span>
                        <span class="n">aoldta</span> <span class="o">=</span> <span class="n">databaseData</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">10</span><span class="p">]</span>
                        <span class="n">bolta</span> <span class="o">=</span> <span class="n">databaseData</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">11</span><span class="p">]</span>
                        <span class="n">boldta</span> <span class="o">=</span> <span class="n">databaseData</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">12</span><span class="p">]</span>

                        <span class="n">asrta</span> <span class="o">=</span> <span class="n">databaseData</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">13</span><span class="p">]</span>
                        <span class="n">asrdta</span> <span class="o">=</span> <span class="n">databaseData</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">14</span><span class="p">]</span>
                        <span class="n">bsrta</span> <span class="o">=</span> <span class="n">databaseData</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">15</span><span class="p">]</span>
                        <span class="n">bsrdta</span> <span class="o">=</span> <span class="n">databaseData</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">16</span><span class="p">]</span>
                        <span class="n">anrta</span> <span class="o">=</span> <span class="n">databaseData</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">17</span><span class="p">]</span>
                        <span class="n">anrdta</span> <span class="o">=</span> <span class="n">databaseData</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">18</span><span class="p">]</span>
                        <span class="n">bnrta</span> <span class="o">=</span> <span class="n">databaseData</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">19</span><span class="p">]</span>
                        <span class="n">bnrdta</span> <span class="o">=</span> <span class="n">databaseData</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">20</span><span class="p">]</span>
                        <span class="n">aorta</span> <span class="o">=</span> <span class="n">databaseData</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">21</span><span class="p">]</span>
                        <span class="n">aordta</span> <span class="o">=</span> <span class="n">databaseData</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">22</span><span class="p">]</span>
                        <span class="n">borta</span> <span class="o">=</span> <span class="n">databaseData</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">23</span><span class="p">]</span>
                        <span class="n">bordta</span> <span class="o">=</span> <span class="n">databaseData</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">24</span><span class="p">]</span>

                        <span class="c1"># FOR LCP</span>
                        <span class="k">if</span> <span class="s1">&#39;ASLTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;ANLTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;AOLTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span><span class="p">:</span>

                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;recalculate pss for all A BEAM lcp&#39;</span><span class="p">)</span>
                            <span class="n">pss</span><span class="p">,</span> <span class="n">psserr</span><span class="p">,</span> <span class="n">pc</span><span class="p">,</span> <span class="n">Tcorr</span><span class="p">,</span> <span class="n">Tcorerr</span><span class="p">,</span> <span class="n">appEff</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pc_pss</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> 
                            <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;ASLTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;ASLDTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;ANLTA&quot;</span><span class="p">],</span> 
                            <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;ANLDTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;AOLTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;AOLDTA&quot;</span><span class="p">],</span> 
                            <span class="n">flux</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;AOLPC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pc</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ACOLTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ACOLDTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorerr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;AOLPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pss</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;AOLDPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">psserr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;AOLAPPEFF&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">appEff</span>

                        <span class="k">if</span> <span class="s1">&#39;BSLTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;BNLTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;BOLTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span><span class="p">:</span>

                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;recalculate pss for all B BEAM lcp&#39;</span><span class="p">)</span>
                            <span class="n">pss</span><span class="p">,</span> <span class="n">psserr</span><span class="p">,</span> <span class="n">pc</span><span class="p">,</span> <span class="n">Tcorr</span><span class="p">,</span> <span class="n">Tcorerr</span><span class="p">,</span> <span class="n">appEff</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pc_pss</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;BSLTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;BSLDTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;BNLTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;BNLDTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;BOLTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;BOLDTA&quot;</span><span class="p">],</span> <span class="n">flux</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BOLPC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pc</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BCOLTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BCOLDTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorerr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BOLPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pss</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BOLDPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">psserr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BOLAPPEFF&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">appEff</span>


                        <span class="k">if</span> <span class="s1">&#39;ASLTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;ANLTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;AOLTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span><span class="p">:</span>

                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;recalculate pss for A BEAM hps and hpn lcp&#39;</span><span class="p">)</span>
                            <span class="n">pss</span><span class="p">,</span> <span class="n">psserr</span><span class="p">,</span> <span class="n">pc</span><span class="p">,</span> <span class="n">Tcorr</span><span class="p">,</span> <span class="n">Tcorerr</span><span class="p">,</span> <span class="n">appEff</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pc_pss</span><span class="p">(</span> <span class="mi">2</span><span class="p">,</span> 
                            <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;ASLTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;ASLDTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;ANLTA&quot;</span><span class="p">],</span> 
                            <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;ANLDTA&quot;</span><span class="p">],</span> <span class="n">aolta</span><span class="p">,</span> <span class="n">aoldta</span><span class="p">,</span> <span class="n">flux</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;AOLPC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pc</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ACOLTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ACOLDTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorerr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;AOLPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pss</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;AOLDPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">psserr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;AOLAPPEFF&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">appEff</span>

                        <span class="k">if</span> <span class="s1">&#39;BSLTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;BNLTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;BOLTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span><span class="p">:</span>

                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;recalculate pss for B BEAM hps and hpn lcp&#39;</span><span class="p">)</span>
                            <span class="n">pss</span><span class="p">,</span> <span class="n">psserr</span><span class="p">,</span> <span class="n">pc</span><span class="p">,</span> <span class="n">Tcorr</span><span class="p">,</span> <span class="n">Tcorerr</span><span class="p">,</span> <span class="n">appEff</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pc_pss</span><span class="p">(</span>
                                <span class="mi">2</span><span class="p">,</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;BSLTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;BSLDTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;BNLTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;BNLDTA&quot;</span><span class="p">],</span> <span class="n">bolta</span><span class="p">,</span> <span class="n">boldta</span><span class="p">,</span> <span class="n">flux</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BOLPC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pc</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BCOLTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BCOLDTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorerr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BOLPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pss</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BOLDPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">psserr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BOLAPPEFF&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">appEff</span>


                        <span class="k">if</span> <span class="s1">&#39;ASLTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;ANLTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;AOLTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span><span class="p">:</span>

                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;recalculate pss for A BEAM s and o lcp&#39;</span><span class="p">)</span>
                            <span class="n">pss</span><span class="p">,</span> <span class="n">psserr</span><span class="p">,</span> <span class="n">pc</span><span class="p">,</span> <span class="n">Tcorr</span><span class="p">,</span> <span class="n">Tcorerr</span><span class="p">,</span> <span class="n">appEff</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pc_pss</span><span class="p">(</span>
                                <span class="mi">2</span><span class="p">,</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;ASLTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;ASLDTA&quot;</span><span class="p">],</span> <span class="n">anlta</span><span class="p">,</span> <span class="n">anldta</span><span class="p">,</span> 
                                <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;AOLTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;AOLDTA&quot;</span><span class="p">],</span> <span class="n">flux</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;AOLPC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pc</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ACOLTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ACOLDTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorerr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;AOLPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pss</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;AOLDPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">psserr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;AOLAPPEFF&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">appEff</span>

                        <span class="k">if</span> <span class="s1">&#39;BSLTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;BNLTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;BOLTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span><span class="p">:</span>

                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;recalculate pss for B BEAM s and o lcp&#39;</span><span class="p">)</span>
                            <span class="n">pss</span><span class="p">,</span> <span class="n">psserr</span><span class="p">,</span> <span class="n">pc</span><span class="p">,</span> <span class="n">Tcorr</span><span class="p">,</span> <span class="n">Tcorerr</span><span class="p">,</span> <span class="n">appEff</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pc_pss</span><span class="p">(</span>
                                <span class="mi">2</span><span class="p">,</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;BSLTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;BSLDTA&quot;</span><span class="p">],</span> <span class="n">bnlta</span><span class="p">,</span> <span class="n">bnldta</span><span class="p">,</span> 
                                <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;BOLTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;BOLDTA&quot;</span><span class="p">],</span> <span class="n">flux</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BOLPC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pc</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BCOLTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BCOLDTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorerr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BOLPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pss</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BOLDPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">psserr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BOLAPPEFF&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">appEff</span>


                        <span class="k">if</span> <span class="s1">&#39;ASLTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;ANLTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;AOLTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span><span class="p">:</span>

                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;recalculate pss for A BEAM s lcp&#39;</span><span class="p">)</span>
                            <span class="n">pss</span><span class="p">,</span> <span class="n">psserr</span><span class="p">,</span> <span class="n">pc</span><span class="p">,</span> <span class="n">Tcorr</span><span class="p">,</span> <span class="n">Tcorerr</span><span class="p">,</span> <span class="n">appEff</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pc_pss</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> 
                            <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;ASLTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;ASLDTA&quot;</span><span class="p">],</span> <span class="n">anlta</span><span class="p">,</span> <span class="n">anldta</span><span class="p">,</span> 
                            <span class="n">aolta</span><span class="p">,</span> <span class="n">aoldta</span><span class="p">,</span> <span class="n">flux</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;AOLPC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pc</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ACOLTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ACOLDTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorerr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;AOLPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pss</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;AOLDPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">psserr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;AOLAPPEFF&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">appEff</span>

                        <span class="k">if</span> <span class="s1">&#39;BSLTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;BNLTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;BOLTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span><span class="p">:</span>

                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;recalculate pss for B BEAM s lcp&#39;</span><span class="p">)</span>
                            <span class="n">pss</span><span class="p">,</span> <span class="n">psserr</span><span class="p">,</span> <span class="n">pc</span><span class="p">,</span> <span class="n">Tcorr</span><span class="p">,</span> <span class="n">Tcorerr</span><span class="p">,</span> <span class="n">appEff</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pc_pss</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> 
                            <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;BSLTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;BSLDTA&quot;</span><span class="p">],</span> <span class="n">bnlta</span><span class="p">,</span> <span class="n">bnldta</span><span class="p">,</span> 
                            <span class="n">bolta</span><span class="p">,</span> <span class="n">boldta</span><span class="p">,</span> <span class="n">flux</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BOLPC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pc</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BCOLTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BCOLDTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorerr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BOLPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pss</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BOLDPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">psserr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BOLAPPEFF&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">appEff</span>


                        <span class="k">if</span> <span class="s1">&#39;ASLTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;ANLTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;AOLTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span><span class="p">:</span>

                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;recalculate A BEAM pss for n lcp&#39;</span><span class="p">)</span>
                            <span class="n">pss</span><span class="p">,</span> <span class="n">psserr</span><span class="p">,</span> <span class="n">pc</span><span class="p">,</span> <span class="n">Tcorr</span><span class="p">,</span> <span class="n">Tcorerr</span><span class="p">,</span> <span class="n">appEff</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pc_pss</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span>
                            <span class="n">aslta</span><span class="p">,</span> <span class="n">asldta</span><span class="p">,</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;ANLTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;ANLDTA&quot;</span><span class="p">],</span> 
                            <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;AOLTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;AOLDTA&quot;</span><span class="p">],</span> <span class="n">flux</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;AOLPC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pc</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ACOLTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ACOLDTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorerr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;AOLPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pss</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;AOLDPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">psserr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;AOLAPPEFF&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">appEff</span>

                        <span class="k">if</span> <span class="s1">&#39;BSLTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;BNLTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;BOLTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span><span class="p">:</span>

                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;recalculate B BEAM pss for n lcp&#39;</span><span class="p">)</span>
                            <span class="n">pss</span><span class="p">,</span> <span class="n">psserr</span><span class="p">,</span> <span class="n">pc</span><span class="p">,</span> <span class="n">Tcorr</span><span class="p">,</span> <span class="n">Tcorerr</span><span class="p">,</span> <span class="n">appEff</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pc_pss</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span>
                            <span class="n">bslta</span><span class="p">,</span> <span class="n">bsldta</span><span class="p">,</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;BNLTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;BNLDTA&quot;</span><span class="p">],</span> 
                            <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;BOLTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;BOLDTA&quot;</span><span class="p">],</span> <span class="n">flux</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BOLPC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pc</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BCOLTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BCOLDTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorerr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BOLPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pss</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BOLDPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">psserr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BOLAPPEFF&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">appEff</span>


                        <span class="k">if</span> <span class="s1">&#39;ASLTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;ANLTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;AOLTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span><span class="p">:</span>

                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;recalculate A BEAM pss for o lcp&#39;</span><span class="p">)</span>
                            <span class="n">pss</span><span class="p">,</span> <span class="n">psserr</span><span class="p">,</span> <span class="n">pc</span><span class="p">,</span> <span class="n">Tcorr</span><span class="p">,</span> <span class="n">Tcorerr</span><span class="p">,</span> <span class="n">appEff</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pc_pss</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span>
                            <span class="n">aslta</span><span class="p">,</span> <span class="n">asldta</span><span class="p">,</span> <span class="n">anlta</span><span class="p">,</span> <span class="n">anldta</span><span class="p">,</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;AOLTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;AOLDTA&quot;</span><span class="p">],</span> 
                            <span class="n">flux</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;AOLPC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pc</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ACOLTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ACOLDTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorerr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;AOLPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pss</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;AOLDPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">psserr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;AOLAPPEFF&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">appEff</span>

                        <span class="k">if</span> <span class="s1">&#39;BSLTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;BNLTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;BOLTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span><span class="p">:</span>

                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;recalculate pss for o lcp&#39;</span><span class="p">)</span>
                            <span class="n">pss</span><span class="p">,</span> <span class="n">psserr</span><span class="p">,</span> <span class="n">pc</span><span class="p">,</span> <span class="n">Tcorr</span><span class="p">,</span> <span class="n">Tcorerr</span><span class="p">,</span> <span class="n">appEff</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pc_pss</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span>
                            <span class="n">bslta</span><span class="p">,</span> <span class="n">bsldta</span><span class="p">,</span> <span class="n">bnlta</span><span class="p">,</span> <span class="n">bnldta</span><span class="p">,</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;BOLTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;BOLDTA&quot;</span><span class="p">],</span> 
                            <span class="n">flux</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BOLPC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pc</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BCOLTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BCOLDTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorerr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BOLPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pss</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BOLDPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">psserr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BOLAPPEFF&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">appEff</span>


                        <span class="k">if</span> <span class="s1">&#39;ASLTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;ANLTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;AOLTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span><span class="p">:</span>

                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;recalculate A BEAM pss for s and o lcp&#39;</span><span class="p">)</span>
                            <span class="n">pss</span><span class="p">,</span> <span class="n">psserr</span><span class="p">,</span> <span class="n">pc</span><span class="p">,</span> <span class="n">Tcorr</span><span class="p">,</span> <span class="n">Tcorerr</span><span class="p">,</span> <span class="n">appEff</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pc_pss</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span>
                            <span class="n">aslta</span><span class="p">,</span> <span class="n">asldta</span><span class="p">,</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;ANLTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;ANLDTA&quot;</span><span class="p">],</span> 
                            <span class="n">aolta</span><span class="p">,</span> <span class="n">aoldta</span><span class="p">,</span> <span class="n">flux</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;AOLPC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pc</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ACOLTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ACOLDTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorerr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;AOLPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pss</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;AOLDPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">psserr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;AOLAPPEFF&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">appEff</span>

                        <span class="k">if</span> <span class="s1">&#39;BSLTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;BNLTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;BOLTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span><span class="p">:</span>

                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;recalculate B BEAM pss for s and o lcp&#39;</span><span class="p">)</span>
                            <span class="n">pss</span><span class="p">,</span> <span class="n">psserr</span><span class="p">,</span> <span class="n">pc</span><span class="p">,</span> <span class="n">Tcorr</span><span class="p">,</span> <span class="n">Tcorerr</span><span class="p">,</span> <span class="n">appEff</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pc_pss</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span>
                            <span class="n">bslta</span><span class="p">,</span> <span class="n">bsldta</span><span class="p">,</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;BNLTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;BNLDTA&quot;</span><span class="p">],</span> 
                            <span class="n">bolta</span><span class="p">,</span> <span class="n">boldta</span><span class="p">,</span> <span class="n">flux</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BOLPC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pc</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BCOLTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BCOLDTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorerr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BOLPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pss</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BOLDPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">psserr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BOLAPPEFF&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">appEff</span>


                        <span class="c1"># FOR RCP</span>
                        <span class="k">if</span> <span class="s1">&#39;ASRTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;ANRTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;AORTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span><span class="p">:</span>

                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;recalculate pss for all A BEAM rcp&#39;</span><span class="p">)</span>
                            <span class="n">pss</span><span class="p">,</span> <span class="n">psserr</span><span class="p">,</span> <span class="n">pc</span><span class="p">,</span> <span class="n">Tcorr</span><span class="p">,</span> <span class="n">Tcorerr</span><span class="p">,</span> <span class="n">appEff</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pc_pss</span><span class="p">(</span>
                                <span class="mi">2</span><span class="p">,</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;ASRTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;ASRDTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;ANRTA&quot;</span><span class="p">],</span> 
                                <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;ANRDTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;AORTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;AORDTA&quot;</span><span class="p">],</span> 
                                <span class="n">flux</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;AORPC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pc</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ACORTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ACORDTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorerr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;AORPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pss</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;AORDPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">psserr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;AORAPPEFF&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">appEff</span>

                        <span class="k">if</span> <span class="s1">&#39;BSRTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;BNRTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;BORTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span><span class="p">:</span>

                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;recalculate pss for all B BEAM rcp&#39;</span><span class="p">)</span>
                            <span class="n">pss</span><span class="p">,</span> <span class="n">psserr</span><span class="p">,</span> <span class="n">pc</span><span class="p">,</span> <span class="n">Tcorr</span><span class="p">,</span> <span class="n">Tcorerr</span><span class="p">,</span> <span class="n">appEff</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pc_pss</span><span class="p">(</span>
                                <span class="mi">2</span><span class="p">,</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;BSRTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;BSRDTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;BNRTA&quot;</span><span class="p">],</span> 
                                <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;BNRDTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;BORTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;BORDTA&quot;</span><span class="p">],</span> 
                                <span class="n">flux</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BORPC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pc</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BCORTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BCORDTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorerr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BORPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pss</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BORDPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">psserr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BORAPPEFF&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">appEff</span>

                        
                        <span class="k">if</span> <span class="s1">&#39;ASRTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;ANRTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;AORTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span><span class="p">:</span>

                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;recalculate pss for A BEAM hps and hpn rcp&#39;</span><span class="p">)</span>
                            <span class="n">pss</span><span class="p">,</span> <span class="n">psserr</span><span class="p">,</span> <span class="n">pc</span><span class="p">,</span> <span class="n">Tcorr</span><span class="p">,</span> <span class="n">Tcorerr</span><span class="p">,</span> <span class="n">appEff</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pc_pss</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;ASRTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;ASRDTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;ANRTA&quot;</span><span class="p">],</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;ANRDTA&quot;</span><span class="p">],</span> <span class="n">aorta</span><span class="p">,</span> <span class="n">aordta</span><span class="p">,</span> <span class="n">flux</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;AORPC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pc</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ACORTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ACORDTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorerr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;AORPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pss</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;AORDPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">psserr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;AORAPPEFF&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">appEff</span>

                        <span class="k">if</span> <span class="s1">&#39;BSRTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;BNRTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;BORTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span><span class="p">:</span>

                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;recalculate pss for B BEAM hps and hpn rcp&#39;</span><span class="p">)</span>
                            <span class="n">pss</span><span class="p">,</span> <span class="n">psserr</span><span class="p">,</span> <span class="n">pc</span><span class="p">,</span> <span class="n">Tcorr</span><span class="p">,</span> <span class="n">Tcorerr</span><span class="p">,</span> <span class="n">appEff</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pc_pss</span><span class="p">(</span>
                                <span class="mi">2</span><span class="p">,</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;BSRTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;BSRDTA&quot;</span><span class="p">],</span> 
                                <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;BNRTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;BNRDTA&quot;</span><span class="p">],</span> <span class="n">borta</span><span class="p">,</span> <span class="n">bordta</span><span class="p">,</span> <span class="n">flux</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BORPC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pc</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BCORTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BCORDTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorerr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BORPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pss</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BORDPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">psserr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BORAPPEFF&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">appEff</span>

                        
                        <span class="k">if</span> <span class="s1">&#39;ASRTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;ANRTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;AORTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span><span class="p">:</span>

                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;recalculate pss for A BEAM s and o rcp&#39;</span><span class="p">)</span>
                            <span class="n">pss</span><span class="p">,</span> <span class="n">psserr</span><span class="p">,</span> <span class="n">pc</span><span class="p">,</span> <span class="n">Tcorr</span><span class="p">,</span> <span class="n">Tcorerr</span><span class="p">,</span> <span class="n">appEff</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pc_pss</span><span class="p">(</span>
                                <span class="mi">2</span><span class="p">,</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;ASRTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;ASRDTA&quot;</span><span class="p">],</span> <span class="n">anrta</span><span class="p">,</span> <span class="n">anrdta</span><span class="p">,</span>
                                <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;AORTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;AORDTA&quot;</span><span class="p">],</span> <span class="n">flux</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;AORPC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pc</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ACORTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ACORDTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorerr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;AORPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pss</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;AORDPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">psserr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;AORAPPEFF&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">appEff</span>

                        <span class="k">if</span> <span class="s1">&#39;BSRTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;BNRTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;BORTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span><span class="p">:</span>

                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;recalculate pss for B BEAM s and o rcp&#39;</span><span class="p">)</span>
                            <span class="n">pss</span><span class="p">,</span> <span class="n">psserr</span><span class="p">,</span> <span class="n">pc</span><span class="p">,</span> <span class="n">Tcorr</span><span class="p">,</span> <span class="n">Tcorerr</span><span class="p">,</span> <span class="n">appEff</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pc_pss</span><span class="p">(</span>
                                <span class="mi">2</span><span class="p">,</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;BSRTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;BSRDTA&quot;</span><span class="p">],</span> <span class="n">bnrta</span><span class="p">,</span> <span class="n">bnrdta</span><span class="p">,</span>
                                <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;BORTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;BORDTA&quot;</span><span class="p">],</span> <span class="n">flux</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BORPC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pc</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BCORTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BCORDTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorerr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BORPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pss</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BORDPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">psserr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BORAPPEFF&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">appEff</span>


                        <span class="k">if</span> <span class="s1">&#39;ASRTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;ANRTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;AORTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span><span class="p">:</span>

                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;recalculate pss for A BEAM s rcp&#39;</span><span class="p">)</span>
                            <span class="n">pss</span><span class="p">,</span> <span class="n">psserr</span><span class="p">,</span> <span class="n">pc</span><span class="p">,</span> <span class="n">Tcorr</span><span class="p">,</span> <span class="n">Tcorerr</span><span class="p">,</span> <span class="n">appEff</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pc_pss</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span>
                                <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;ASRTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;ASRDTA&quot;</span><span class="p">],</span> <span class="n">anrta</span><span class="p">,</span> <span class="n">anrdta</span><span class="p">,</span>
                                <span class="n">aorta</span><span class="p">,</span> <span class="n">aordta</span><span class="p">,</span> <span class="n">flux</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;AORPC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pc</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ACORTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ACORDTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorerr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;AORPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pss</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;AORDPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">psserr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;AORAPPEFF&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">appEff</span>

                        <span class="k">if</span> <span class="s1">&#39;BSRTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;BNRTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;BORTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span><span class="p">:</span>

                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;recalculate pss for B BEAM s rcp&#39;</span><span class="p">)</span>
                            <span class="n">pss</span><span class="p">,</span> <span class="n">psserr</span><span class="p">,</span> <span class="n">pc</span><span class="p">,</span> <span class="n">Tcorr</span><span class="p">,</span> <span class="n">Tcorerr</span><span class="p">,</span> <span class="n">appEff</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pc_pss</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span>
                                <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;BSRTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;BSRDTA&quot;</span><span class="p">],</span> <span class="n">bnrta</span><span class="p">,</span> <span class="n">bnrdta</span><span class="p">,</span>
                                <span class="n">borta</span><span class="p">,</span> <span class="n">bordta</span><span class="p">,</span> <span class="n">flux</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BORPC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pc</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BCORTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BCORDTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorerr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BORPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pss</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BORDPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">psserr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BORAPPEFF&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">appEff</span>


                        <span class="k">if</span> <span class="s1">&#39;ASRTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;ANRTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;AORTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span><span class="p">:</span>

                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;recalculate A BEAM pss for n rcp&#39;</span><span class="p">)</span>
                            <span class="n">pss</span><span class="p">,</span> <span class="n">psserr</span><span class="p">,</span> <span class="n">pc</span><span class="p">,</span> <span class="n">Tcorr</span><span class="p">,</span> <span class="n">Tcorerr</span><span class="p">,</span> <span class="n">appEff</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pc_pss</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span>
                                <span class="n">asrta</span><span class="p">,</span> <span class="n">asrdta</span><span class="p">,</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;ANRTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;ANRDTA&quot;</span><span class="p">],</span>
                                <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;AORTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;AORDTA&quot;</span><span class="p">],</span> <span class="n">flux</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;AORPC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pc</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ACORTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ACORDTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorerr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;AORPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pss</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;AORDPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">psserr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;AORAPPEFF&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">appEff</span>

                        <span class="k">if</span> <span class="s1">&#39;BSRTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;BNRTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;BORTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span><span class="p">:</span>

                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;recalculate B BEAM pss for n rcp&#39;</span><span class="p">)</span>
                            <span class="n">pss</span><span class="p">,</span> <span class="n">psserr</span><span class="p">,</span> <span class="n">pc</span><span class="p">,</span> <span class="n">Tcorr</span><span class="p">,</span> <span class="n">Tcorerr</span><span class="p">,</span> <span class="n">appEff</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pc_pss</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span>
                                <span class="n">bsrta</span><span class="p">,</span> <span class="n">bsrdta</span><span class="p">,</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;BNRTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;BNRDTA&quot;</span><span class="p">],</span>
                                <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;BORTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;BORDTA&quot;</span><span class="p">],</span> <span class="n">flux</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BORPC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pc</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BCORTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BCORDTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorerr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BORPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pss</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BORDPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">psserr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BORAPPEFF&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">appEff</span>


                        <span class="k">if</span> <span class="s1">&#39;ASRTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;ANRTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;AORTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span><span class="p">:</span>

                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;recalculate A BEAM pss for o rcp&#39;</span><span class="p">)</span>
                            <span class="n">pss</span><span class="p">,</span> <span class="n">psserr</span><span class="p">,</span> <span class="n">pc</span><span class="p">,</span> <span class="n">Tcorr</span><span class="p">,</span> <span class="n">Tcorerr</span><span class="p">,</span> <span class="n">appEff</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pc_pss</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span>
                                <span class="n">asrta</span><span class="p">,</span> <span class="n">asrdta</span><span class="p">,</span> <span class="n">anrta</span><span class="p">,</span> <span class="n">anrdta</span><span class="p">,</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;AORTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;AORDTA&quot;</span><span class="p">],</span>
                                <span class="n">flux</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;AORPC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pc</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ACORTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ACORDTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorerr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;AORPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pss</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;AORDPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">psserr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;AORAPPEFF&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">appEff</span>

                        <span class="k">if</span> <span class="s1">&#39;BSRTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;BNRTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;BORTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span><span class="p">:</span>

                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;recalculate pss for B BEAM o rcp&#39;</span><span class="p">)</span>
                            <span class="n">pss</span><span class="p">,</span> <span class="n">psserr</span><span class="p">,</span> <span class="n">pc</span><span class="p">,</span> <span class="n">Tcorr</span><span class="p">,</span> <span class="n">Tcorerr</span><span class="p">,</span> <span class="n">appEff</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pc_pss</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span>
                                <span class="n">bsrta</span><span class="p">,</span> <span class="n">bsrdta</span><span class="p">,</span> <span class="n">bnrta</span><span class="p">,</span> <span class="n">bnrdta</span><span class="p">,</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;BORTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;BORDTA&quot;</span><span class="p">],</span>
                                <span class="n">flux</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BORPC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pc</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BCORTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BCORDTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorerr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BORPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pss</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BORDPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">psserr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BORAPPEFF&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">appEff</span>


                        <span class="k">if</span> <span class="s1">&#39;ASRTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;ANRTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;AORTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span><span class="p">:</span>

                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;recalculate A BEAM pss for s and o rcp&#39;</span><span class="p">)</span>
                            <span class="n">pss</span><span class="p">,</span> <span class="n">psserr</span><span class="p">,</span> <span class="n">pc</span><span class="p">,</span> <span class="n">Tcorr</span><span class="p">,</span> <span class="n">Tcorerr</span><span class="p">,</span> <span class="n">appEff</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pc_pss</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span>
                                <span class="n">asrta</span><span class="p">,</span> <span class="n">asrdta</span><span class="p">,</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;ANRTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;ANRDTA&quot;</span><span class="p">],</span>
                                <span class="n">aorta</span><span class="p">,</span> <span class="n">aordta</span><span class="p">,</span> <span class="n">flux</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;AORPC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pc</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ACORTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ACORDTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorerr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;AORPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pss</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;AORDPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">psserr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;AORAPPEFF&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">appEff</span>

                        <span class="k">if</span> <span class="s1">&#39;BSRTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;BNRTA&#39;</span> <span class="ow">in</span> <span class="n">queryKeys</span> <span class="ow">and</span> <span class="s1">&#39;BORTA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">queryKeys</span><span class="p">:</span>

                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;recalculate B BEAM pss for s and o rcp&#39;</span><span class="p">)</span>
                            <span class="n">pss</span><span class="p">,</span> <span class="n">psserr</span><span class="p">,</span> <span class="n">pc</span><span class="p">,</span> <span class="n">Tcorr</span><span class="p">,</span> <span class="n">Tcorerr</span><span class="p">,</span> <span class="n">appEff</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pc_pss</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span>
                                <span class="n">bsrta</span><span class="p">,</span> <span class="n">bsrdta</span><span class="p">,</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;BNRTA&quot;</span><span class="p">],</span> <span class="n">queryDict</span><span class="p">[</span><span class="s2">&quot;BNRDTA&quot;</span><span class="p">],</span>
                                <span class="n">borta</span><span class="p">,</span> <span class="n">bordta</span><span class="p">,</span> <span class="n">flux</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BORPC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pc</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BCORTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BCORDTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tcorerr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BORPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pss</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BORDPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">psserr</span>
                            <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BORAPPEFF&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">appEff</span>

            <span class="c1"># elif 2 in status:</span>

            <span class="c1">#     if &quot;TAR&quot; in data[&#39;OBJECTTYPE&#39;]:</span>
            <span class="c1">#         stmt = &quot;SELECT &quot;+dbKeysList[:-1]+&quot; FROM &quot;+table + \</span>
            <span class="c1">#             &#39; WHERE FILENAME = &quot;&#39; + filename+&#39;&quot; ;&#39;</span>
            <span class="c1">#     else:</span>
            <span class="c1">#         if &quot;CAL&quot; in data[&#39;OBJECTTYPE&#39;] and data[&quot;OBJECT&quot;] == &quot;JUPITER&quot;:</span>
            <span class="c1">#             stmt = &quot;SELECT TOTAL_PLANET_FLUX_D,&quot;+dbKeys+&quot; FROM &quot;+table + \</span>
            <span class="c1">#                 &#39; WHERE FILENAME = &quot;&#39; + filename+&#39;&quot; ;&#39;</span>
            <span class="c1">#         else:</span>
            <span class="c1">#             stmt = &quot;SELECT FLUX,&quot;+dbKeys+&quot; FROM &quot;+table + \</span>
            <span class="c1">#                 &#39; WHERE FILENAME = &quot;&#39; + filename+&#39;&quot; ;&#39;</span>

            <span class="c1">#         self.c.execute(stmt)</span>
            <span class="c1">#         databaseData = self.c.fetchall()</span>

            <span class="c1">#         if &quot;S&quot; in data[&#39;BEAMTYPE&#39;]:</span>
            <span class="c1">#             flux = databaseData[0][0]</span>
            <span class="c1">#             slta = databaseData[0][1]</span>
            <span class="c1">#             sldta = databaseData[0][2]</span>
            <span class="c1">#             nlta = databaseData[0][3]</span>
            <span class="c1">#             nldta = databaseData[0][4]</span>
            <span class="c1">#             olta = databaseData[0][5]</span>
            <span class="c1">#             oldta = databaseData[0][6]</span>
            <span class="c1">#             srta = databaseData[0][7]</span>
            <span class="c1">#             srdta = databaseData[0][8]</span>
            <span class="c1">#             nrta = databaseData[0][9]</span>
            <span class="c1">#             nrdta = databaseData[0][10]</span>
            <span class="c1">#             orta = databaseData[0][11]</span>
            <span class="c1">#             ordta = databaseData[0][12]</span>

            <span class="c1">#             # FOR LCP</span>
            <span class="c1">#             if &#39;SLTA&#39; in queryKeys and &#39;NLTA&#39; in queryKeys and &#39;OLTA&#39; in queryKeys:</span>
            <span class="c1">#                 # recalculate pss</span>
            <span class="c1">#                 print(&#39;setting lcp pss to None&#39;)</span>
            <span class="c1">#                 queryDict = self.set_lcp_stats(queryDict)</span>

            <span class="c1">#             if &#39;SLTA&#39; in queryKeys and &#39;NLTA&#39; in queryKeys and &#39;OLTA&#39; not in queryKeys:</span>
            <span class="c1">#                 print(&#39;setting lcp pss to None&#39;)</span>
            <span class="c1">#                 #queryDict = self.set_lcp_stats(queryDict)</span>

            <span class="c1">#                 print(&#39;recalculate pss for hps and hpn lcp&#39;)</span>
            <span class="c1">#                 pss, psserr, pc, Tcorr, Tcorerr, appEff = cp.calc_pc_pss(2,</span>
            <span class="c1">#                     queryDict[&quot;SLTA&quot;], queryDict[&quot;SLDTA&quot;], queryDict[&quot;NLTA&quot;], </span>
            <span class="c1">#                     queryDict[&quot;NLDTA&quot;], olta, oldta, flux, data)</span>

            <span class="c1">#                 queryDict[&#39;OLPC&#39;] = pc</span>
            <span class="c1">#                 queryDict[&#39;COLTA&#39;] = Tcorr</span>
            <span class="c1">#                 queryDict[&#39;COLDTA&#39;] = Tcorerr</span>
            <span class="c1">#                 queryDict[&#39;OLPSS&#39;] = pss</span>
            <span class="c1">#                 queryDict[&#39;OLDPSS&#39;] = psserr</span>
            <span class="c1">#                 queryDict[&#39;OLAPPEFF&#39;] = appEff</span>

            <span class="c1">#             if &#39;SLTA&#39; in queryKeys and &#39;NLTA&#39; not in queryKeys and &#39;OLTA&#39; in queryKeys:</span>
            <span class="c1">#                 print(&#39;setting lcp pss to None&#39;)</span>
            <span class="c1">#                 queryDict = self.set_lcp_stats(queryDict)</span>

            <span class="c1">#             if &#39;SLTA&#39; in queryKeys and &#39;NLTA&#39; not in queryKeys and &#39;OLTA&#39; not in queryKeys:</span>
            <span class="c1">#                 print(&#39;setting lcp pss to None&#39;)</span>
            <span class="c1">#                 queryDict = self.set_lcp_stats(queryDict)</span>
                            
            <span class="c1">#             if &#39;SLTA&#39; not in queryKeys and &#39;NLTA&#39; in queryKeys and &#39;OLTA&#39; in queryKeys:</span>
            <span class="c1">#                 print(&#39;setting lcp pss to None&#39;)</span>
            <span class="c1">#                 queryDict = self.set_lcp_stats(queryDict)</span>

            <span class="c1">#             if &#39;SLTA&#39; not in queryKeys and &#39;NLTA&#39; not in queryKeys and &#39;OLTA&#39; in queryKeys:</span>
            <span class="c1">#                 print(&#39;setting lcp pss to None&#39;)</span>
            <span class="c1">#                 queryDict = self.set_lcp_stats(queryDict)</span>

            <span class="c1">#             if &#39;SLTA&#39; not in queryKeys and &#39;NLTA&#39; in queryKeys and &#39;OLTA&#39; not in queryKeys:</span>
            <span class="c1">#                 print(&#39;setting lcp pss to None&#39;)</span>
            <span class="c1">#                 queryDict = self.set_lcp_stats(queryDict)</span>

            <span class="c1">#             # FOR RCP</span>

            <span class="c1">#             if &#39;SRTA&#39; in queryKeys and &#39;NRTA&#39; in queryKeys and &#39;ORTA&#39; in queryKeys:</span>
            <span class="c1">#                 print(&#39;setting lcp pss to None&#39;)</span>
            <span class="c1">#                 queryDict = self.set_rcp_stats(queryDict)</span>

            <span class="c1">#             if &#39;SRTA&#39; in queryKeys and &#39;NRTA&#39; in queryKeys and &#39;ORTA&#39; not in queryKeys:</span>
            <span class="c1">#                 print(&#39;setting lcp pss to None&#39;)</span>
            <span class="c1">#                 queryDict = self.set_rcp_stats(queryDict)</span>

            <span class="c1">#             if &#39;SRTA&#39; in queryKeys and &#39;NRTA&#39; not in queryKeys and &#39;ORTA&#39; in queryKeys:</span>
            <span class="c1">#                 print(&#39;setting lcp pss to None&#39;)</span>
            <span class="c1">#                 queryDict = self.set_rcp_stats(queryDict)</span>

            <span class="c1">#             if &#39;SRTA&#39; in queryKeys and &#39;NRTA&#39; not in queryKeys and &#39;ORTA&#39; not in queryKeys:</span>
            <span class="c1">#                 print(&#39;setting lcp pss to None&#39;)</span>
            <span class="c1">#                 queryDict = self.set_rcp_stats(queryDict)</span>

            <span class="c1">#             if &#39;SRTA&#39; not in queryKeys and &#39;NRTA&#39; in queryKeys and &#39;ORTA&#39; in queryKeys:</span>
            <span class="c1">#                 print(&#39;setting lcp pss to None&#39;)</span>
            <span class="c1">#                 queryDict = self.set_rcp_stats(queryDict)</span>

            <span class="c1">#             if &#39;SRTA&#39; not in queryKeys and &#39;NRTA&#39; not in queryKeys and &#39;ORTA&#39; in queryKeys:</span>
            <span class="c1">#                 print(&#39;setting lcp pss to None&#39;)</span>
            <span class="c1">#                 queryDict = self.set_rcp_stats(queryDict)</span>

            <span class="c1">#             if &#39;SRTA&#39; not in queryKeys and &#39;NRTA&#39; in queryKeys and &#39;ORTA&#39; not in queryKeys:</span>
            <span class="c1">#                 print(&#39;setting lcp pss to None&#39;)</span>
            <span class="c1">#                 queryDict = self.set_rcp_stats(queryDict)</span>

            <span class="c1">#         elif &quot;D&quot; in data[&quot;BEAMTYPE&quot;]:</span>

            <span class="c1">#             # FOR LCP</span>
            <span class="c1">#             if &#39;ASLTA&#39; in queryKeys and &#39;ANLTA&#39; in queryKeys and &#39;AOLTA&#39; in queryKeys:</span>

            <span class="c1">#                 print(&#39;recalculate pss for all A BEAM lcp&#39;)</span>
            <span class="c1">#                 queryDict = self.set_a_lcp_stats(queryDict)</span>

            <span class="c1">#             if &#39;BSLTA&#39; in queryKeys and &#39;BNLTA&#39; in queryKeys and &#39;BOLTA&#39; in queryKeys:</span>

            <span class="c1">#                 print(&#39;recalculate pss for all B BEAM lcp&#39;)</span>
            <span class="c1">#                 queryDict = self.set_b_lcp_stats(queryDict)</span>

            <span class="c1">#             if &#39;ASLTA&#39; in queryKeys and &#39;ANLTA&#39; in queryKeys and &#39;AOLTA&#39; not in queryKeys:</span>

            <span class="c1">#                 print(&#39;recalculate pss for A BEAM hps and hpn lcp&#39;)</span>
            <span class="c1">#                 queryDict = self.set_a_lcp_stats(queryDict)</span>

            <span class="c1">#             if &#39;BSLTA&#39; in queryKeys and &#39;BNLTA&#39; in queryKeys and &#39;BOLTA&#39; not in queryKeys:</span>

            <span class="c1">#                 print(&#39;recalculate pss for B BEAM hps and hpn lcp&#39;)</span>
            <span class="c1">#                 queryDict = self.set_b_lcp_stats(queryDict)</span>

            <span class="c1">#             if &#39;ASLTA&#39; in queryKeys and &#39;ANLTA&#39; not in queryKeys and &#39;AOLTA&#39; in queryKeys:</span>

            <span class="c1">#                 print(&#39;recalculate pss for A BEAM s and o lcp&#39;)</span>
            <span class="c1">#                 queryDict = self.set_a_lcp_stats(queryDict)</span>

            <span class="c1">#             if &#39;BSLTA&#39; in queryKeys and &#39;BNLTA&#39; not in queryKeys and &#39;BOLTA&#39; in queryKeys:</span>

            <span class="c1">#                 print(&#39;recalculate pss for B BEAM s and o lcp&#39;)</span>
            <span class="c1">#                 queryDict = self.set_b_lcp_stats(queryDict)</span>

            <span class="c1">#             if &#39;ASLTA&#39; in queryKeys and &#39;ANLTA&#39; not in queryKeys and &#39;AOLTA&#39; not in queryKeys:</span>

            <span class="c1">#                 print(&#39;recalculate pss for A BEAM s lcp&#39;)</span>
            <span class="c1">#                 queryDict = self.set_a_lcp_stats(queryDict)</span>

            <span class="c1">#             if &#39;BSLTA&#39; in queryKeys and &#39;BNLTA&#39; not in queryKeys and &#39;BOLTA&#39; not in queryKeys:</span>

            <span class="c1">#                 print(&#39;recalculate pss for B BEAM s lcp&#39;)</span>
            <span class="c1">#                 queryDict = self.set_b_lcp_stats(queryDict)</span>

            <span class="c1">#             if &#39;ASLTA&#39; not in queryKeys and &#39;ANLTA&#39; in queryKeys and &#39;AOLTA&#39; in queryKeys:</span>

            <span class="c1">#                 print(&#39;recalculate A BEAM pss for n lcp&#39;)</span>
            <span class="c1">#                 queryDict = self.set_a_lcp_stats(queryDict)</span>

            <span class="c1">#             if &#39;BSLTA&#39; not in queryKeys and &#39;BNLTA&#39; in queryKeys and &#39;BOLTA&#39; in queryKeys:</span>

            <span class="c1">#                 print(&#39;recalculate B BEAM pss for n lcp&#39;)</span>
            <span class="c1">#                 queryDict = self.set_b_lcp_stats(queryDict)</span>

            <span class="c1">#             if &#39;ASLTA&#39; not in queryKeys and &#39;ANLTA&#39; not in queryKeys and &#39;AOLTA&#39; in queryKeys:</span>

            <span class="c1">#                 print(&#39;recalculate A BEAM pss for o lcp&#39;)</span>
            <span class="c1">#                 queryDict = self.set_a_lcp_stats(queryDict)</span>

            <span class="c1">#             if &#39;BSLTA&#39; not in queryKeys and &#39;BNLTA&#39; not in queryKeys and &#39;BOLTA&#39; in queryKeys:</span>

            <span class="c1">#                 print(&#39;recalculate pss for o lcp&#39;)</span>
            <span class="c1">#                 queryDict = self.set_b_lcp_stats(queryDict)</span>

            <span class="c1">#             if &#39;ASLTA&#39; not in queryKeys and &#39;ANLTA&#39; in queryKeys and &#39;AOLTA&#39; not in queryKeys:</span>

            <span class="c1">#                 print(&#39;recalculate A BEAM pss for s and o lcp&#39;)</span>
            <span class="c1">#                 queryDict = self.set_a_lcp_stats(queryDict)</span>

            <span class="c1">#             if &#39;BSLTA&#39; not in queryKeys and &#39;BNLTA&#39; in queryKeys and &#39;BOLTA&#39; not in queryKeys:</span>

            <span class="c1">#                 print(&#39;recalculate B BEAM pss for s and o lcp&#39;)</span>
            <span class="c1">#                 queryDict = self.set_b_lcp_stats(queryDict)</span>

            <span class="c1">#             # FOR RCP</span>
            <span class="c1">#             if &#39;ASRTA&#39; in queryKeys and &#39;ANRTA&#39; in queryKeys and &#39;AORTA&#39; in queryKeys:</span>

            <span class="c1">#                 print(&#39;recalculate pss for all A BEAM rcp&#39;)</span>
            <span class="c1">#                 queryDict = self.set_a_rcp_stats(queryDict)</span>

            <span class="c1">#             if &#39;BSRTA&#39; in queryKeys and &#39;BNRTA&#39; in queryKeys and &#39;BORTA&#39; in queryKeys:</span>

            <span class="c1">#                 print(&#39;recalculate pss for all B BEAM rcp&#39;)</span>
            <span class="c1">#                 queryDict = self.set_b_rcp_stats(queryDict)</span>

            <span class="c1">#             if &#39;ASRTA&#39; in queryKeys and &#39;ANRTA&#39; in queryKeys and &#39;AORTA&#39; not in queryKeys:</span>

            <span class="c1">#                 print(&#39;recalculate pss for A BEAM hps and hpn rcp&#39;)</span>
            <span class="c1">#                 queryDict = self.set_a_rcp_stats(queryDict)</span>

            <span class="c1">#             if &#39;BSRTA&#39; in queryKeys and &#39;BNRTA&#39; in queryKeys and &#39;BORTA&#39; not in queryKeys:</span>

            <span class="c1">#                 print(&#39;recalculate pss for B BEAM hps and hpn rcp&#39;)</span>
            <span class="c1">#                 queryDict = self.set_b_rcp_stats(queryDict)</span>


            <span class="c1">#             if &#39;ASRTA&#39; in queryKeys and &#39;ANRTA&#39; not in queryKeys and &#39;AORTA&#39; in queryKeys:</span>

            <span class="c1">#                 print(&#39;recalculate pss for A BEAM s and o rcp&#39;)</span>
            <span class="c1">#                 queryDict = self.set_a_rcp_stats(queryDict)</span>

            <span class="c1">#             if &#39;BSRTA&#39; in queryKeys and &#39;BNRTA&#39; not in queryKeys and &#39;BORTA&#39; in queryKeys:</span>

            <span class="c1">#                 print(&#39;recalculate pss for B BEAM s and o rcp&#39;)</span>
            <span class="c1">#                 queryDict = self.set_b_rcp_stats(queryDict)</span>


            <span class="c1">#             if &#39;ASRTA&#39; in queryKeys and &#39;ANRTA&#39; not in queryKeys and &#39;AORTA&#39; not in queryKeys:</span>

            <span class="c1">#                 print(&#39;recalculate pss for A BEAM s rcp&#39;)</span>
            <span class="c1">#                 queryDict = self.set_a_rcp_stats(queryDict)</span>

            <span class="c1">#             if &#39;BSRTA&#39; in queryKeys and &#39;BNRTA&#39; not in queryKeys and &#39;BORTA&#39; not in queryKeys:</span>

            <span class="c1">#                 print(&#39;recalculate pss for B BEAM s rcp&#39;)</span>
            <span class="c1">#                 queryDict = self.set_b_rcp_stats(queryDict)</span>


            <span class="c1">#             if &#39;ASRTA&#39; not in queryKeys and &#39;ANRTA&#39; in queryKeys and &#39;AORTA&#39; in queryKeys:</span>

            <span class="c1">#                 print(&#39;recalculate A BEAM pss for n rcp&#39;)</span>
            <span class="c1">#                 queryDict = self.set_a_rcp_stats(queryDict)</span>

            <span class="c1">#             if &#39;BSRTA&#39; not in queryKeys and &#39;BNRTA&#39; in queryKeys and &#39;BORTA&#39; in queryKeys:</span>

            <span class="c1">#                 print(&#39;recalculate B BEAM pss for n rcp&#39;)</span>
            <span class="c1">#                 queryDict = self.set_b_rcp_stats(queryDict)</span>


            <span class="c1">#             if &#39;ASRTA&#39; not in queryKeys and &#39;ANRTA&#39; not in queryKeys and &#39;AORTA&#39; in queryKeys:</span>

            <span class="c1">#                 print(&#39;recalculate A BEAM pss for o rcp&#39;)</span>
            <span class="c1">#                 queryDict = self.set_a_rcp_stats(queryDict)</span>

            <span class="c1">#             if &#39;BSRTA&#39; not in queryKeys and &#39;BNRTA&#39; not in queryKeys and &#39;BORTA&#39; in queryKeys:</span>

            <span class="c1">#                 print(&#39;recalculate pss for B BEAM o rcp&#39;)</span>
            <span class="c1">#                 queryDict = self.set_b_rcp_stats(queryDict)</span>


            <span class="c1">#             if &#39;ASRTA&#39; not in queryKeys and &#39;ANRTA&#39; in queryKeys and &#39;AORTA&#39; not in queryKeys:</span>

            <span class="c1">#                 print(&#39;recalculate A BEAM pss for s and o rcp&#39;)</span>
            <span class="c1">#                 queryDict = self.set_a_rcp_stats(queryDict)</span>

            <span class="c1">#             if &#39;BSRTA&#39; not in queryKeys and &#39;BNRTA&#39; in queryKeys and &#39;BORTA&#39; not in queryKeys:</span>

            <span class="c1">#                 print(&#39;recalculate B BEAM pss for s and o rcp&#39;)</span>
            <span class="c1">#                 queryDict = self.set_b_rcp_stats(queryDict)</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;setting everything to nans&quot;</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Beam length out of range&quot;</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>

        <span class="n">queryList</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">key</span> <span class="o">+</span><span class="s2">&quot;=&#39;&quot;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">val</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;&#39;&quot;</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">queryDict</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
        <span class="c1">#print(queryList)</span>
        <span class="c1">#print(queryDict)</span>
        <span class="c1">#sys.exit()</span>
        <span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;UPDATE &quot;</span><span class="o">+</span><span class="n">table</span><span class="o">+</span><span class="s2">&quot; SET &quot;</span><span class="o">+</span><span class="n">queryList</span> <span class="o">+</span> \
            <span class="s1">&#39; WHERE FILENAME = &quot;&#39;</span> <span class="o">+</span> <span class="n">filename</span><span class="o">+</span><span class="s1">&#39;&quot; ;&#39;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Update query: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
      
        <span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">commit_changes</span><span class="p">()</span></div>

<div class="viewcode-block" id="SQLiteDB.set_lcp_stats"><a class="viewcode-back" href="../../../docs/src.common.html#src.common.sqlite_db.SQLiteDB.set_lcp_stats">[docs]</a>    <span class="k">def</span> <span class="nf">set_lcp_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">queryDict</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot; set the pss entries for lcp&quot;&quot;&quot;</span>
        <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;OLPC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
        <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;COLTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
        <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;COLDTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
        <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;OLPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
        <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;OLDPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
        <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;OLAPPEFF&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">queryDict</span></div>

<div class="viewcode-block" id="SQLiteDB.set_rcp_stats"><a class="viewcode-back" href="../../../docs/src.common.html#src.common.sqlite_db.SQLiteDB.set_rcp_stats">[docs]</a>    <span class="k">def</span> <span class="nf">set_rcp_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">queryDict</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;set the pss entries for lcp&quot;&quot;&quot;</span>       
        <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ORPC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
        <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;CORTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
        <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;CORDTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
        <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ORPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
        <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ORDPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
        <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ORAPPEFF&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">queryDict</span></div>

<div class="viewcode-block" id="SQLiteDB.set_a_lcp_stats"><a class="viewcode-back" href="../../../docs/src.common.html#src.common.sqlite_db.SQLiteDB.set_a_lcp_stats">[docs]</a>    <span class="k">def</span> <span class="nf">set_a_lcp_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">queryDict</span><span class="p">):</span>
<span class="w">        </span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; set the pss entries for lcp&quot;&quot;&quot;</span>
        <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;AOLPC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
        <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ACOLTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
        <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ACOLDTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
        <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;AOLPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
        <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;AOLDPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
        <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;AOLAPPEFF&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">queryDict</span></div>

<div class="viewcode-block" id="SQLiteDB.set_b_lcp_stats"><a class="viewcode-back" href="../../../docs/src.common.html#src.common.sqlite_db.SQLiteDB.set_b_lcp_stats">[docs]</a>    <span class="k">def</span> <span class="nf">set_b_lcp_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">queryDict</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot; set the pss entries for lcp&quot;&quot;&quot;</span>
        <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BOLPC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
        <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BCOLTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
        <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BCOLDTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
        <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BOLPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
        <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BOLDPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
        <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BOLAPPEFF&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">queryDict</span></div>

<div class="viewcode-block" id="SQLiteDB.set_a_rcp_stats"><a class="viewcode-back" href="../../../docs/src.common.html#src.common.sqlite_db.SQLiteDB.set_a_rcp_stats">[docs]</a>    <span class="k">def</span> <span class="nf">set_a_rcp_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">queryDict</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot; set the pss entries for lcp&quot;&quot;&quot;</span>
        <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;AORPC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
        <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ACORTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
        <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;ACORDTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
        <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;AORPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
        <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;AORDPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
        <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;AORAPPEFF&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">queryDict</span></div>

<div class="viewcode-block" id="SQLiteDB.set_b_rcp_stats"><a class="viewcode-back" href="../../../docs/src.common.html#src.common.sqlite_db.SQLiteDB.set_b_rcp_stats">[docs]</a>    <span class="k">def</span> <span class="nf">set_b_rcp_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">queryDict</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot; set the pss entries for lcp&quot;&quot;&quot;</span>
        <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BORPC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
        <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BCORTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
        <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BCORDTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
        <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BORPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
        <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BORDPSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
        <span class="n">queryDict</span><span class="p">[</span><span class="s1">&#39;BORAPPEFF&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">queryDict</span></div></div>
</pre></div>

            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">dran v1.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" >Module code</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">src.common.sqlite_db</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2023, Pfesi van Zyl.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 6.2.1.
    </div>
  </body>
</html>